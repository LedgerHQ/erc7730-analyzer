# üìä Clear Signing Audit Report

**Generated:** 2025-10-28 10:14:28

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | üü¢ Minor | Minor UI clarity: The intent "Wrap" is correct, but the display shows only the r... | [View](#selector-d0e30db0) |

---

## üìà Statistics

| Metric | Count |
|--------|-------|
| üî¥ Critical | 0 |
| üü° Major | 1 |
| üü¢ Minor | 0 |
| ‚úÖ No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>üìã ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": [
      {
        "path": "@.value",
        "label": "Amount",
        "format": "amount"
      }
    ]
  }
}
```

</details>

<details>
<summary><b>üîç Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x283a3d4ef91eea4d243977ef12a3a5a904e7be42054b520a867432db21142566`

**Block:** 23675250 | **From:** 0x3092f5e2eb2e7e148cd5f899721ff2f41dae76f3 | **Value:** 85000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0x65d1ebf43c725c0de314920671e4c4a6494ffdaadda9a0494bcf15a66da69083`

**Block:** 23675250 | **From:** 0xc2c437c1d8a050c488549a5a234532f14482af8d | **Value:** 9000000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0x054fb8fbeea0ea6636fcd73d074bfaa79369a570a3115569e05482fb9f3b9fc7`

**Block:** 23675250 | **From:** 0x38a602e6de45e346983186f3640dd710f225ef7d | **Value:** 1000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0x2ac9a0ff6adf70daf163587bd6d2cf56fafc6dc0357cd60a06d283888949e951`

**Block:** 23675248 | **From:** 0xadd02fbc685195d4e1e8a9ef73ad0cf78e57f1d0 | **Value:** 28000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0x20dfd9c960fed77f627e3ca08efe5c576c154826edf600c8b3b3e1b738e95624`

**Block:** 23675242 | **From:** 0x54c6d73baf9dd8612978b694b23a309263b54cfa | **Value:** 170000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

üîç Clear Signing Audit Report

üìã Function: deposit()

Selector: 0xd0e30db0

---

1Ô∏è‚É£ Intent Analysis

> **Declared Intent:** "Wrap"

The intent "Wrap" is accurate and clear for a payable deposit() that accepts ETH (msg.value) and credits an internal/WETH balance; no spelling/grammar errors.

---

2Ô∏è‚É£ Critical Issues

> üî¥ **CRITICAL** - Issues that could lead to users being deceived or losing funds

‚úÖ No critical issues found

Rationale (concise):
- The ERC-7730 format displays "@.value" with format "amount" ‚Äî that directly reflects msg.value (ETH sent). deposit() is payable and increments balanceOf[msg.sender] by msg.value and emits Deposit; receipt_logs show the WETH Deposit event with the exact amounts. There are no mismatched token addresses, inverted flows, missing recipient parameters, broken $ref references, or missing native ETH support for displayed fields.

---

3Ô∏è‚É£ Missing Parameters

> ‚ö†Ô∏è Parameters present in ABI but NOT shown to users in ERC-7730

**‚úÖ All parameters are covered**

- deposit() has no input parameters beyond msg.value; ERC-7730 uses "@.value" to show the sent amount. Nothing missing.

---

4Ô∏è‚É£ Display Issues

> üü° Issues with how information is presented to users

- Minor UI clarity: The intent "Wrap" is correct, but the display shows only the raw ETH amount (via @.value). It does not explicitly state the resulting token (WETH) or that the contract balanceOf mapping increased. This is a UX/display omission, not a correctness issue.
- Event decoding: receipt_logs show the Deposit event signature but labeled "Unknown" in the provided data. This is an off-chain decoder issue (not ERC-7730 metadata) ‚Äî recommend ensuring event ABI is available for richer on-chain verification in the UI.
- No $ref or nativeCurrencyAddress issues: using "@.value" (format "amount") is appropriate for payable ETH input; there is no tokenAmount field that would require nativeCurrencyAddress.

Recommendation (display-level)
- Consider augmenting metadata to indicate "Wrap ETH ‚Üí WETH" or include a static label for the receiving token (WETH) so users see both "You send ETH (msg.value)" and "You receive WETH (balance credited)". This is optional and UX-focused.

---

5Ô∏è‚É£ Transaction Samples - What Users See vs What Actually Happens

(Analyzed 3 representative txs)

Transaction 1 (sample)
User Intent (from ERC-7730):

| Field | ‚úÖ User Sees | ‚ùå Hidden/Missing |
|---|---:|---|
| Amount | 0.085 ETH (from @.value) | None ‚Äî the sent ETH amount is shown |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|---|---|:---:|
| Deposit event | Contract (WETH) emitted Deposit(msg.sender, 0.085 ETH) ‚Äî credited to depositor's WETH balance | ‚úÖ Yes (amount matches @.value) |
| ERC20 Transfer | Not present in provided logs (WETH may not emit a Transfer here) | ‚ùå N/A |

Transaction 2 (sample)
User Intent (from ERC-7730):

| Field | ‚úÖ User Sees | ‚ùå Hidden/Missing |
|---|---:|---|
| Amount | 9.0 ETH | None relevant |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|---|---|:---:|
| Deposit event | Deposit(msg.sender, 9.0 ETH) emitted by WETH contract | ‚úÖ Yes (amount matches) |

Transaction 3 (sample)
User Intent (from ERC-7730):

| Field | ‚úÖ User Sees | ‚ùå Hidden/Missing |
|---|---:|---|
| Amount | 0.001 ETH | None relevant |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|---|---|:---:|
| Deposit event | Deposit(msg.sender, 0.001 ETH) emitted | ‚úÖ Yes (amount matches) |

Summary for samples:
- What the user sees (msg.value) matches the on-chain Deposit events. No hidden token swaps, no unexpected transfers to third parties, and no mismatch between displayed and actual amounts.

---

6Ô∏è‚É£ Overall Assessment

| Metric | Score/Rating | Explanation |
|---|---:|---|
| Coverage Score | 9/10 | ERC-7730 shows the ETH amount (msg.value) correctly. Slight UX improvement possible: explicitly show target token (WETH) or resulting credit. |
| Security Risk | üü¢ Low | The action is simple (ETH deposit ‚Üí balance credited); logs match displayed amount. No misleading token/address mapping or missing recipients. |

üí° Key Recommendations
- Explicitly indicate resulting token (WETH) in the display/metadata (e.g., "Wrap ETH ‚Üí WETH" or show receiving token symbol) so users understand that ETH is converted/credited as WETH balance.
- Ensure event ABIs (Deposit event) are included in the off-chain decoder so receipt_logs are labelled (not "Unknown") in UI tooling.
- (Optional) Add a short note in the display: "Amount is msg.value (native ETH). Contract credits your WETH balance." ‚Äî clarifies behavior for non-technical users.

--- 

If you want, I can produce a suggested small ERC-7730 metadata snippet that shows both the ETH input (via @.value) and a static receiving token (WETH) label for better UX.

---

