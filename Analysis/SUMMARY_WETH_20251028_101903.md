# üìä Clear Signing Audit Report

**Generated:** 2025-10-28 10:19:03

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | üü¢ Minor | The metadata displays only the ETH amount (path "@.value", label "Amount") and d... | [View](#selector-d0e30db0) |

---

## üìà Statistics

| Metric | Count |
|--------|-------|
| üî¥ Critical | 0 |
| üü° Major | 1 |
| üü¢ Minor | 0 |
| ‚úÖ No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>üìã ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": [
      {
        "path": "@.value",
        "label": "Amount",
        "format": "amount"
      }
    ]
  }
}
```

</details>

<details>
<summary><b>üîç Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x5c58b07275a90bde2a2f01044f9ce282bca50060bcbd0c606ceab8b0ca8f117e`

**Block:** 23675272 | **From:** 0xfa2fdf7731b833a751f499f0f58fac79271cd87e | **Value:** 100000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0x8be25dcb22337139088c11c1c7bfa623e653c4a9b71b5e47a4909f3d3488ef2c`

**Block:** 23675270 | **From:** 0xc2e1f7dec9c16dd74b82a131ef4d1beb1f4b9016 | **Value:** 1500000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0x4e716c71965149103eab721aed24f62be303b4066612cde4fb4eadce2c4586b2`

**Block:** 23675267 | **From:** 0xc1ffb0fdaa2fac35b5a15d46254d7a9d2cb91476 | **Value:** 347359009456669755

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0x6b938a4b9cfe7a821429ad41494631b75ae9493ee8f8c618d9847db728e5beed`

**Block:** 23675258 | **From:** 0x37ca0e68deb131a2038e7287b041e5652d94c2b8 | **Value:** 1192787753108999

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0x283a3d4ef91eea4d243977ef12a3a5a904e7be42054b520a867432db21142566`

**Block:** 23675250 | **From:** 0x3092f5e2eb2e7e148cd5f899721ff2f41dae76f3 | **Value:** 85000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

üîç Clear Signing Audit Report

üìã Function: deposit()
Selector: 0xd0e30db0

> **Declared Intent:** "Wrap"

One-sentence assessment: The intent "Wrap" is accurate and concise (it indicates ETH ‚Üí wrapped token), no spelling/grammar issues.

> üî¥ **CRITICAL** - Issues that could lead to users being deceived or losing funds

‚úÖ No critical issues found.

Reasoning (critical check summary)
- The function is payable and uses msg.value; the ERC-7730 field uses path "@.value" with format "amount" ‚Äî that correctly displays the native ETH sent.
- There are no $ref references that could be broken.
- There are no input parameters omitted from the display that would allow a user to be surprised about a recipient or token address (recipient is msg.sender, not an input param).
- Receipt logs show the Deposit event (signature 0xe1fffcc4...) matching a WETH-style deposit. That does not contradict the display. No approvals, no inverted tokens, no mismatched final amounts found in logs vs displayed field.

---

### 3Ô∏è‚É£ Missing Parameters

> ‚ö†Ô∏è Parameters present in ABI but NOT shown to users in ERC-7730

The function has no ABI input parameters (only msg.value). The display covers the only actionable input (msg.value).

‚úÖ All parameters are covered

---

### 4Ô∏è‚É£ Display Issues

> üü° Issues with how information is presented to users

- The metadata displays only the ETH amount (path "@.value", label "Amount") and does not explicitly show the receiving token (WETH). This can be confusing to users who expect an explicit "You will receive: WETH" line when the intent is "Wrap".
  - Impact: non-critical (no money lost), but may confuse some users or UIs that rely on tokenAmount fields to show balances.
  - Fix: add a field that explicitly indicates the receiving asset (WETH token address / symbol) or include a tokenAmount field for the received WETH.
- The contract emits a Deposit event but (in the provided source snippet) there is no Transfer log shown in receipt_logs. Some UIs rely on ERC20 Transfer events to detect token minting/transfers; because Deposit is a nonstandard event, some trackers might not auto-detect the incoming wrapped token balance. This is a display/UX issue, not a funds-loss issue.
  - Fix: metadata should explicitly state "Receives: WETH" (tokenAmount) so UI isn't reliant solely on ERC20 Transfer parsing.
- No $ref or constant mismatches found; format is minimal and correct. No spelling/grammar issues.

Display-edge case note (medium severity, not critical):
- Because the display trusts msg.value to show ETH amount but does not include an explicit tokenAddress for the wrapped token, a UI that only shows "Amount: X ETH" may not make it clear that the contract will credit WETH in exchange. If a user expects a different token label, they could be confused. Best practice: show both sides (ETH sent and WETH received).

---

### 5Ô∏è‚É£ Transaction Samples - What Users See vs What Actually Happens

(Do not include tx hash / block / from / tx.value as requested. Focus on fields & events.)

Transaction sample A (representative)
User Intent (from ERC-7730):

| Field (ERC-7730) | ‚úÖ User Sees | ‚ùå Hidden / Missing |
|---|---:|---|
| Amount | msg.value (ETH amount) | Receiving asset (WETH) is not shown |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|---|---|---:|
| Deposit(address indexed, uint256) | Contract logs Deposit for the caller with the deposited amount (indicates wrapped balance increased) | ‚ùå Not explicitly shown by ERC-7730 |
| ERC20 Transfer | Not present in logs (so some token trackers may not auto-detect mint) | n/a |

Transaction sample B (representative)
User Intent (from ERC-7730):

| Field (ERC-7730) | ‚úÖ User Sees | ‚ùå Hidden / Missing |
|---|---:|---|
| Amount | msg.value (ETH amount) | No explicit "You will receive WETH" line |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|---|---|---:|
| Deposit event | Deposit logged (caller credited) | ‚ùå Not mapped to a tokenAmount display |

Transaction sample C (representative)
User Intent (from ERC-7730):

| Field (ERC-7730) | ‚úÖ User Sees | ‚ùå Hidden / Missing |
|---|---:|---|
| Amount | msg.value (ETH amount) | Symbol/address of wrapped token not shown |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|---|---|---:|
| Deposit event | Logged amount matches msg.value | ‚úÖ The deposit event exists on-chain, but ERC-7730 doesn't call it out as "received token" |

Summary of samples: For all samples the displayed information (msg.value) matches the on-chain deposit. What is missing is an explicit "received token" mapping (WETH); the logs contain a Deposit event but no standard Transfer event in the provided logs, so UIs that only watch ERC20 Transfer may not surface the received WETH.

---

### 6Ô∏è‚É£ Overall Assessment

| Metric | Score / Rating | Explanation |
|---|---:|---|
| Coverage Score | 8.5 / 10 | Amount input (msg.value) is covered correctly. Missing an explicit received-token field (WETH) costs points for UX clarity. |
| Security Risk | üü¢ Low | No mismatches in amounts or tokens that would cause loss of funds; logs match displayed input amount. |

#### üí° Key Recommendations
- Add an explicit receiving-asset field to the ERC-7730 metadata:
  - Example: include a tokenAmount field (or simple token label) indicating WETH (contract address) as the received asset so UIs show both sides: "Send X ETH" ‚Üí "Receive X WETH".
- If possible, include a constant for the wrapped token address in metadata.constants (e.g., metadata.constants.weth) and reference it in the display definition. That avoids relying on heuristics or log parsing to show the received token.
- Document in UI copy that the Deposit event mints/credits wrapped token balance (and that an ERC20 Transfer may not be emitted in this contract variant). This prevents confusion for users and integrators that expect Transfer logs.
- Optional: If you control contract code and want better UX across wallets, emit an ERC20 Transfer(address(0), msg.sender, amount) on deposit (standard WETH9 does emit it). If not changing code, ensure display metadata compensates.

---

If you want, I can produce an example patch to the ERC-7730 JSON to add a receiving token field (tokenAmount) referencing a constant WETH address, and show exactly how to add metadata.constants and a tokenAmount definition.

---

