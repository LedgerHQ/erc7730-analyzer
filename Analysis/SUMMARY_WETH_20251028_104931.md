# üìä Clear Signing Audit Report

**Generated:** 2025-10-28 10:49:31

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | üî¥ Critical | Missing display of msg.value (ETH sent): deposit() is payable and the user supplies ETH. ERC-7730 me... | [View](#selector-d0e30db0) |

---

## üìà Statistics

| Metric | Count |
|--------|-------|
| üî¥ Critical | 1 |
| üü° Major | 0 |
| üü¢ Minor | 0 |
| ‚úÖ No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>üìã ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>üîç Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0xb9a413a05e703190874e59ee16e2e6465a546e365b232d7beaf99d26a6dd1e0d`

**Block:** 23675413 | **From:** 0xb81f22712fea02ee735bc969051efaaa25ecb587 | **Value:** 250000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0x01dc5b7d7615968c5de25df309ce9a0c54b044df9745440bb031ac3cd073c4ea`

**Block:** 23675410 | **From:** 0x2563f5fa3bdc65838ae8fd3353b62d66f695ca6d | **Value:** 19400000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0x4683ecefbd76e9a693cd48ce5ce98e8653dd5ee5bcaa1a5042fc2795ddb3603a`

**Block:** 23675407 | **From:** 0xecaa514ce7ddf6a2174630ee49320cff8ff47b44 | **Value:** 31347160219160900

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0xa6648111d81ee28e31aec349a652119a81288f4b20f0b34622c883d997b6c106`

**Block:** 23675406 | **From:** 0x13f2ca08112fd5b5df3c78c5e583d95d69900235 | **Value:** 437000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0x3bbb88cfa857676c9f44bd553ed366ff24ccf97a0c88fa0cae1b2341bf235d2d`

**Block:** 23675406 | **From:** 0xa84abb4c5df2c5e6d83850ce165993b361d47367 | **Value:** 70000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

## üîç Clear Signing Audit Report

### üìã Function: deposit()
Selector: 0xd0e30db0

> **Declared Intent:** *"Wrap"*

This intent is generally accurate (deposit() on WETH wraps ETH ‚Üí WETH), concise and grammatically fine, but the metadata's lack of fields makes the intent too vague for users to understand amounts or tokens.

---

### 1Ô∏è‚É£ Intent Analysis
The metadata intent "Wrap" matches the actual contract behavior: the function is payable and credits balanceOf[msg.sender] with msg.value (i.e., wrapping native ETH into an ERC-20 balance). However, intent alone is insufficient ‚Äî the display must show the ETH amount sent and the WETH received for a clear user decision.

---

### 2Ô∏è‚É£ Critical Issues
> üî¥ **CRITICAL** - Issues that could lead to users being deceived or losing funds

- Missing display of msg.value (ETH sent): deposit() is payable and the user supplies ETH. ERC-7730 metadata has no fields; it does not display "@.value" or otherwise show the native amount the user is sending. This is critical because the ETH amount is an input param the user must see.
- Missing display of received token (WETH) and its amount: The contract credits balanceOf[msg.sender] for the WETH contract itself; logs show deposit events with amounts equal to the sent ETH, but metadata does not show the token or amount received. Users would not see what token they will get credited.

Why critical:
- Both the ETH sent and token received are determinable from the transaction inputs / contract address and are fundamental to the user's expectation. Hiding them risks user confusion and surprise about final value/tokens.

Not flagged (but noted):
- There are no broken $ref references in the provided format (it has no refs).
- Recipient is implicit (msg.sender) and not an input parameter, so missing recipient field is NOT critical per the rules.

---

### 3Ô∏è‚É£ Missing Parameters
> ‚ö†Ô∏è *Parameters present in ABI but NOT shown to users in ERC-7730*

| Parameter | Why It's Important | Risk Level |
|-----------|-------------------:|:----------:|
| msg.value (ETH sent) | Core input ‚Äî amount of ETH the user is paying into deposit() | üî¥ High |
| Received token (WETH address and amount) | Final asset credited to user ‚Äî must be shown so user knows what they will receive | üî¥ High |

Explanation: deposit() has no ABI parameters but relies on msg.value (an implicit input). The contract credit (WETH balance) is the primary output. Both are not shown.

If no parameters were missing, the line would be "‚úÖ All parameters are covered", but here both key pieces are missing.

---

### 4Ô∏è‚É£ Display Issues
> üü° **Issues with how information is presented to users**

- Metadata "fields": [] (empty). No amount-in, no token-out, no labels ‚Äî too sparse for a payable wrap operation.
- No "@.value" path shown ‚Äî the canonical way to show native ETH sent is absent.
- No tokenAmount field referencing the WETH contract address (tx.to) to show the received token and amount.
- Potential ambiguity for users: "Wrap" could mean many things (ETH‚ÜíWETH or token wrapping). Without explicit fields the UI has nothing to show.
- Minor: There are no $ref usages to verify, so nothing broken, but the absence of definitions/constants or fields is itself a display defect.
- Edge case: Because the deposit action deterministically credits the token contract (address this) with msg.value to msg.sender, the token received is the contract itself (WETH). Metadata should avoid trusting user input to indicate token type ‚Äî here the token is known (contract address). The current metadata fails to hardcode/display that.

Recommended display fixes (examples):
- Add an input display for ETH sent:
  {"path":"@.value","label":"ETH to wrap","format":"amount"}
- Add an output tokenAmount for WETH received, referencing the contract address (tx.to) or a metadata constant:
  {"path":"@.value","label":"WETH received","format":"tokenAmount","params":{"tokenPath":["$.to"]}}
  ‚Äî or define a constant: "metadata.constants.weth": "0xc02aaa..." then tokenPath constant.

---

### 5Ô∏è‚É£ Transaction Samples - What Users See vs What Actually Happens
(Analyzing 3 sample txs from provided logs. We do NOT repeat hash/block/from/value as requested.)

General note: decoded_input is empty for these deposit() calls (deposit has no ABI args). receipt_logs all show an event with signature 0xe1fffcc4... and topics indicating the depositor; data carries the amount ‚Äî these are the deposit events emitted by the WETH contract (amount equals msg.value).

#### üìù Transaction 1 (first sample)
User Intent (from ERC-7730):

| Field | ‚úÖ User Sees | ‚ùå Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" (metadata) | Exact ETH amount sent (msg.value) |
| Fields | none | Token received (WETH) and amount credited |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:---------:|
| Deposit event | Contract (WETH) emitted Deposit indexed depositor = user, data = 0x...3782dace9d90000 (250000000000000000 wei) | ‚ùå Not shown by metadata |
| Net effect | User's WETH balance increased by msg.value | ‚ùå Not shown |

Conclusion: The receipt log shows the ETH‚ÜíWETH deposit and amount, but ERC-7730 displays only "Wrap" and no amounts or tokens.

#### üìù Transaction 2 (second sample)
User Intent (from ERC-7730):

| Field | ‚úÖ User Sees | ‚ùå Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | ETH amount (0.0194 ETH) |
| Fields | none | WETH token and amount credited |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:---------:|
| Deposit event | depositor = user, data = 0x...44ec327ca48000 (19400000000000000 wei) | ‚ùå Not shown |
| Net effect | WETH credited to user equal to ETH sent | ‚ùå Not shown |

#### üìù Transaction 3 (third sample)
User Intent (from ERC-7730):

| Field | ‚úÖ User Sees | ‚ùå Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | ETH amount (0.0313471602191609 ETH) |
| Fields | none | WETH token and amount credited |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:---------:|
| Deposit event | depositor = user, data = 0x...6f5e137d949144 (31347160219160900 wei) | ‚ùå Not shown |
| Net effect | WETH credited to user equal to ETH sent | ‚ùå Not shown |

Summary: In every sample the contract emits a deposit event and credits WETH by the same amounts as msg.value. The metadata provides no fields to show either side.

---

### 6Ô∏è‚É£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 2/10 | Intent present ("Wrap") but zero fields to show essential inputs/outputs (ETH in, WETH out). |
| **Security Risk** | üü° Medium | The contract behavior is benign (standard WETH deposit), but hiding ETH amount and received token is a high UX risk: users can accidentally send ETH without seeing amount or resulting token. No direct theft or approval issues present, but display omission is critical for user expectations. |

#### üí° Key Recommendations
- Required (fix ASAP):
  1. Add a field to display msg.value: {"path":"@.value","label":"ETH to wrap","format":"amount"} so users see exactly how much native ETH they are sending.
  2. Add a field to display the token received (WETH) and amount. Example:
     {"path":"@.value","label":"WETH received","format":"tokenAmount","params":{"tokenPath":["$.to"]}}
     or set a metadata constant for the WETH address and reference that token address explicitly in tokenPath.
- Recommended (improve clarity):
  3. Change intent label to "Wrap ETH ‚Üí WETH" and add clear labels for "From" and "To" (From: ETH, To: WETH) so users are not left guessing.
  4. If your display library requires nativeCurrencyAddress for tokenAmount when showing ETH, ensure nativeCurrencyAddress is set for any tokenAmount fields that might present ETH; otherwise use "@.value" with format "amount".
- Optional:
  5. Show the deposit event in a compact form: "Deposit event: WETH credited X to your address" using receipt_logs mapping for confirmation.

---

If you want, I can produce an ERC-7730 format snippet (JSON) that implements the recommended fields (showing ETH in and WETH out) that you can drop into the registry.

---

