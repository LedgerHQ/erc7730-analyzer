# ğŸ“Š Clear Signing Audit Report

**Generated:** 2025-10-28 10:57:13

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | ğŸŸ¢ Minor | No fields are defined in the selector format. The UI will only show the single i... | [View](#selector-d0e30db0) |

---

## ğŸ“ˆ Statistics

| Metric | Count |
|--------|-------|
| ğŸ”´ Critical | 0 |
| ğŸŸ¡ Major | 1 |
| ğŸŸ¢ Minor | 0 |
| âœ… No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>ğŸ“‹ ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>ğŸ” Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x7041fd32dd9051befec4b9cf71512cbf8323258b9da7349ebcb0dd1bb987d23f`

**Block:** 23675463 | **From:** 0xf72860fbe21c6ee10292738a2324ebf847822a94 | **Value:** 90000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0xabcba1416f8c66ff2043304667f1406888fdba33c7ee0aac4fce94e7dc6182c4`

**Block:** 23675459 | **From:** 0xf9b9df708d01f794bb5442eff4f5233ce8760b09 | **Value:** 1000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0xa9eb2a969906f98af1ce0d39f1baf7e34582ad993df92507c20ad4591b5b183c`

**Block:** 23675450 | **From:** 0xf55369de9c417e6aee657828217b6824961df4e3 | **Value:** 90000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0xcc07aa4072c3ffb5d0f782699a2d6e8c4e476d9c93db56af7faff6be9e4c8754`

**Block:** 23675447 | **From:** 0x190849e6c53eb69cb4181448bad585aff8ecaf46 | **Value:** 1000000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0x8c3f616ebb101897e48e80f39a74cca8deb4149f15d1e612f2682d1616823e67`

**Block:** 23675432 | **From:** 0x79cbee95fd3597de9ad2dcadb19dce92da666167 | **Value:** 1000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

## ğŸ” Clear Signing Audit Report

### ğŸ“‹ Function: `deposit()`

**Selector:** `0xd0e30db0`

---

### 1ï¸âƒ£ Intent Analysis

> **Declared Intent:** *"Wrap"*

> The intent "Wrap" is concise and grammatically fine â€” it correctly suggests wrapping native ETH into the token, but it is minimal and does not show amounts or the receiving token (WETH).

---

### 2ï¸âƒ£ Critical Issues

> ğŸ”´ **CRITICAL** - Issues that could lead to users being deceived or losing funds

âœ… No critical issues found

Notes: The function is payable and simply credits balanceOf[msg.sender] with msg.value and emits Deposit. The ERC-7730 metadata contains no fields, so it does not display amounts or token addresses â€” this is a display omission but does not by itself cause money to be lost or tokens to be swapped to the wrong token. There are no broken $ref references, no mismatched ABI parameter paths, and no hidden recipient input parameter. Per the conservative rules, this is not a critical issue because the missing info (msg.value) is not an ABI input parameter and the actual on-chain effects (deposit of ETH â†’ WETH credited to sender) are consistent with the declared intent.

---

### 3ï¸âƒ£ Missing Parameters

> âš ï¸ *Parameters present in ABI but NOT shown to users in ERC-7730*

| Parameter | Why It's Important | Risk Level |
|-----------|--------------------|:----------:|
| (none) | deposit() has no ABI parameters | ğŸŸ¢ Low |

âœ… All parameters are covered

Note: msg.value is not an ABI parameter (it is transaction value). ERC-7730 can show msg.value via path "@.value" but the provided format omits fields entirely â€” this is a display omission (see Display Issues).

---

### 4ï¸âƒ£ Display Issues

> ğŸŸ¡ **Issues with how information is presented to users**

- No fields are defined in the selector format. The UI will only show the single intent "Wrap" and no additional details (no amount, no token, no recipient).
- Missing display of the ETH amount the user is sending (msg.value). ERC-7730 can show this via a field with path "@.value" or a tokenAmount field referencing nativeCurrencyAddress â€” neither is present.
- Missing explicit disclosure that the user will receive WETH (the ERC-20 token at the contract address). The contract mints/credits the token balanceOf[msg.sender] for the same amount as msg.value, but the metadata does not state the receiving token address or tokenAmount mapping.
- No tokenAddress / tokenAmount definitions or nativeCurrencyAddress sentinel are present. Because deposit() is payable and mints WETH, showing the receiving token as the contract address (WETH) is important for clarity.
- Potential UX confusion: users may not realize "Wrap" means "send ETH, get WETH at this contract". This is a display clarity issue (medium severity for user confusion).
- No $ref or definitions are used â€” therefore nothing broken in references, but also no ability to reuse tokenAmount definitions or nativeCurrencyAddress.

Display-edge-case note:
- Because the contract always accepts native ETH (msg.value) and credits WETH, the display should not rely on user-input token parameters (there are none). Instead it should explicitly show msg.value as the amount being sent and show the receiving token as the WETH token (contract address). Relying on a user-supplied tokenPath would be wrong here (not applicable for this selector).

---

### 5ï¸âƒ£ Transaction Samples - What Users See vs What Actually Happens

(Analyzed without including transaction hashes/values per instructions)

#### ğŸ“ Transaction 1

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden / Missing |
|-------|-------------|---------------------|
| Intent | "Wrap" | Amount sent (msg.value) â€” not shown |
| â€” | â€” | Receiving token (WETH contract) â€” not shown |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | Emits depositor (sender) and amount = msg.value | âŒ No (metadata has no fields) |
| Internal state | balanceOf[sender] increased by msg.value (WETH credited) | âŒ No |

#### ğŸ“ Transaction 2 (different sender)

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden / Missing |
|-------|-------------|---------------------|
| Intent | "Wrap" | Amount sent (msg.value) â€” not shown |
| â€” | â€” | Receiving token (WETH) â€” not shown |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | deposit emitted with sender and amount | âŒ No |
| Internal state | balanceOf incremented for sender | âŒ No |

#### ğŸ“ Transaction 3

Same pattern for other sample transactions: users send native ETH (msg.value); the contract emits Deposit log and credits WETH balance. None of these are disclosed in the selector metadata because fields are empty.

---

### 6ï¸âƒ£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 2/10 | The selector metadata declares an intent "Wrap" but provides no fields â€” it fails to show amount or receiving token; minimal coverage. |
| **Security Risk** | ğŸŸ¢ Low | The contract behavior is simple and matches the intent (ETH â†’ WETH). The omission is a UI/display clarity issue rather than a misrepresentation that would cause loss of funds. |

#### ğŸ’¡ Key Recommendations
- Add explicit fields to the selector format:
  - Show the amount sent: add a field with "path": "@.value", "format": "amount" (or tokenAmount referencing nativeCurrencyAddress) so msg.value is clearly displayed as ETH.
  - Show the receiving token: add a tokenAmount field (or a simple label) that points to the contract address (the WETH token) so user sees they will receive WETH (token address = selector target).
    - Example (conceptual): a field labeled "You receive" with format tokenAmount and tokenPath pointing to the WETH contract address.
- Do not rely on user-supplied token parameters (none exist here). Hardcode the receiving token to the contract address for clarity.
- Add a short label/description to the intent to make it clearer, e.g., "Wrap ETH â†’ WETH (deposit)" or "Wrap ETH to WETH".
- Optional: Include a display of the Deposit event in a concise "On-chain effects" section (e.g., "Contract emits Deposit(sender, amount) and credits WETH to your balance") so users see both the action and the resulting token credit.

---

Overall: Function behavior matches intent (ETH deposited â†’ WETH credited). The ERC-7730 metadata is minimal and should be extended to show amount (msg.value) and receiving token (WETH contract) to avoid user confusion. No critical issues per the conservative rule set.

---

