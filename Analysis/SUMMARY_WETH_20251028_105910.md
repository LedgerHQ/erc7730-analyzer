# ğŸ“Š Clear Signing Audit Report

**Generated:** 2025-10-28 10:59:10

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | ğŸ”´ Critical | ERC-7730 has no fields defined (fields: []), so the display does not show the native ETH amount the ... | [View](#selector-d0e30db0) |

---

## ğŸ“ˆ Statistics

| Metric | Count |
|--------|-------|
| ğŸ”´ Critical | 1 |
| ğŸŸ¡ Major | 0 |
| ğŸŸ¢ Minor | 0 |
| âœ… No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>ğŸ“‹ ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>ğŸ” Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x7041fd32dd9051befec4b9cf71512cbf8323258b9da7349ebcb0dd1bb987d23f`

**Block:** 23675463 | **From:** 0xf72860fbe21c6ee10292738a2324ebf847822a94 | **Value:** 90000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0xabcba1416f8c66ff2043304667f1406888fdba33c7ee0aac4fce94e7dc6182c4`

**Block:** 23675459 | **From:** 0xf9b9df708d01f794bb5442eff4f5233ce8760b09 | **Value:** 1000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0xa9eb2a969906f98af1ce0d39f1baf7e34582ad993df92507c20ad4591b5b183c`

**Block:** 23675450 | **From:** 0xf55369de9c417e6aee657828217b6824961df4e3 | **Value:** 90000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0xcc07aa4072c3ffb5d0f782699a2d6e8c4e476d9c93db56af7faff6be9e4c8754`

**Block:** 23675447 | **From:** 0x190849e6c53eb69cb4181448bad585aff8ecaf46 | **Value:** 1000000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0x8c3f616ebb101897e48e80f39a74cca8deb4149f15d1e612f2682d1616823e67`

**Block:** 23675432 | **From:** 0x79cbee95fd3597de9ad2dcadb19dce92da666167 | **Value:** 1000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

## ğŸ” Clear Signing Audit Report

### ğŸ“‹ Function: deposit()

**Selector:** 0xd0e30db0

---

### 1ï¸âƒ£ Intent Analysis

> **Declared Intent:** "Wrap"

The intent "Wrap" is appropriate for a typical payable deposit that converts native ETH into an internal token balance (WETH-like), but the metadata is minimal and doesn't explain what is being wrapped or show amounts â€” grammar/spelling fine.

---

### 2ï¸âƒ£ Critical Issues

> ğŸ”´ **CRITICAL** - Issues that could lead to users being deceived or losing funds

- ERC-7730 has no fields defined (fields: []), so the display does not show the native ETH amount the user is actually sending (msg.value). deposit() is payable and the on-chain effect is that msg.value is added to balanceOf[msg.sender] and a Deposit event is emitted. Because the format provides no path "@.value" or tokenAmount with nativeCurrencyAddress, the user-facing display produced from this metadata cannot show the incoming ETH amount. This meets the spec's native ETH handling critical condition (native ETH is transferred and display cannot show it).
  - Why critical: The user will not see the amount of ETH they are depositing in the action summary produced by this ERC-7730 metadata, which is a primary piece of information for a payable deposit. A regular user would be surprised/concerned if the action says "Wrap" but shows no amount.

No other criticals found:
- There are no broken $ref references.
- There are no input parameters missing from the ABI (function has none).
- The receiving token (WETH) address is not an input param (contract-internal), so omission of that constant is not CRITICAL by the rules (but recommended to show).

---

### 3ï¸âƒ£ Missing Parameters

> âš ï¸ *Parameters present in ABI but NOT shown to users in ERC-7730*

Function has no ABI parameters (deposit() takes no inputs). The important data for this call is msg.value, which is not an ABI parameter but is required to communicate to the user.

âœ… All ABI parameters are covered (none). However, msg.value is not surfaced by the format â€” see critical issues.

---

### 4ï¸âƒ£ Display Issues

> ğŸŸ¡ **Issues with how information is presented to users**

- No fields at all:
  - The metadata only declares intent "Wrap" and provides an empty fields array. This produces an uninformative UI: user sees intent but not the amount, nor the asset (WETH) minted/credited.
- Missing explicit native ETH handling:
  - The format lacks a field referencing "@.value" or a tokenAmount definition that includes nativeCurrencyAddress. For a payable deposit, the display should present the ETH amount.
- Suggest showing the received token:
  - The contract is a WETH-style wrapper; display should indicate that the user receives WETH (contract token). This token address is a constant (contract itself), so metadata can include it in constants/definitions so the UI can show "You will receive: WETH".
- Minor: The single-word intent "Wrap" is okay, but more explicit label like "Deposit ETH (wrap to WETH)" would be clearer.
- No spelling/grammar issues.

Display edge-case note:
- If the metadata were to rely on a user-supplied tokenPath (e.g., receivingAssetId) while the contract always accepts native ETH, that would be a medium display issue; in this case the contract takes msg.value and there are no token parameters, so the metadata should not rely on user input to indicate token type.

---

### 5ï¸âƒ£ Transaction Samples - What Users See vs What Actually Happens

(We analyze 3 of the provided samples. Per instructions, we do not repeat tx hashes/blocks/from/value top-level fields.)

#### ğŸ“ Transaction 1 (sample with Deposit event)

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | â€” |
| Amount | (nothing shown) | msg.value (ETH sent) |
| Receiving token | (not shown) | contract token balance credited (WETH-like) |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit (event) | deposit event emitted with amount (encoded in data) | âŒ Not shown by metadata |
| balanceOf change (on-chain) | contract increments balanceOf[msg.sender] by msg.value (user receives internal WETH balance) | âŒ Not shown by metadata |

#### ğŸ“ Transaction 2

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | â€” |
| Amount | (nothing) | msg.value (ETH sent) |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit (event) | deposit event with amount present in logs | âŒ Not shown |
| balanceOf increment | user credited with token units equal to msg.value | âŒ Not shown |

#### ğŸ“ Transaction 3

Same pattern: metadata shows only "Wrap", actual logs show Deposit event and amount. The amount and resulting token balance are not surfaced by ERC-7730.

---

### 6ï¸âƒ£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 3/10 | Intent declared ("Wrap") but essential data (msg.value and received token) is not shown; minimal metadata only. |
| **Security Risk** | ğŸŸ¡ Medium | Missing display of the ETH amount is a usability/security issue (users may accidentally send ETH without seeing amount). Not a direct reentrancy/exploit risk, but a high-risk UX omission for payable calls. |

#### ğŸ’¡ Key Recommendations
- Immediately add a field to display msg.value:
  - Minimal: {"path":"@.value","label":"Amount","format":"amount"}
  - Preferred (token-aware native display): {"path":"@.value","label":"Amount","$ref":"$.display.definitions.tokenAmount","params":{"nativeCurrencyAddress":["$.metadata.constants.addressAsEth"]}}
- Add a field showing the receiving token (WETH) and amount minted/credited â€” use a constant token address in metadata so it's not reliant on user input. Example: show "Receive: [WETH tokenAddress]" and amount equal to msg.value (or show as tokenAmount referencing that constant).
- Improve intent label: change "Wrap" to "Deposit / Wrap ETH â†’ WETH" and add explanatory text that deposit() credits an on-contract WETH balance.
- Optionally: include a confirmation note that the function uses msg.value (ETH sent with the transaction) so wallets render an explicit fee/amount row.

---

If you want, I can produce the exact JSON snippet to patch the ERC-7730 metadata (fields, definitions/constants) so wallets will correctly show the msg.value and the WETH received.

---

