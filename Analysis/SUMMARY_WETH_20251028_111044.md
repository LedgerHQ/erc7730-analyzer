# ğŸ“Š Clear Signing Audit Report

**Generated:** 2025-10-28 11:10:44

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | ğŸŸ¢ Minor | No amount shown: | [View](#selector-d0e30db0) |

---

## ğŸ“ˆ Statistics

| Metric | Count |
|--------|-------|
| ğŸ”´ Critical | 0 |
| ğŸŸ¡ Major | 1 |
| ğŸŸ¢ Minor | 0 |
| âœ… No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>ğŸ“‹ ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>ğŸ” Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0xc31c859d09aff3a3f76af778e890135349ffcd8506b60dac80e2cd677e22b79c`

**Block:** 23675528 | **From:** 0x533813aa3c513a0079aa268ec3141f67e4b11a2e | **Value:** 190000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0x2223be593a4f6e85b8a615daf556a766e761af413536889e243a719cf856415b`

**Block:** 23675518 | **From:** 0x13f2ca08112fd5b5df3c78c5e583d95d69900235 | **Value:** 138000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0xabf581af4130143c212992b099a1a6ed5e5a5a70ca13c69450895170951ccf8d`

**Block:** 23675514 | **From:** 0x6ff412f54e10588a2cf0442ccfb228f866ff1684 | **Value:** 1000000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0x65f2365168bb3fb163ff58de6e982294ae7ce32e028e917a20a7a9922edaf8fb`

**Block:** 23675514 | **From:** 0x1346d9c6315f6c23fe280b49ef215aebd49338b2 | **Value:** 2000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0xa5901f90553eeadc8d0235673cf8acae9941bac75f7e2936f5e890e781403f50`

**Block:** 23675513 | **From:** 0xeede62f1773fdb74e5ac9965f43a359a955713cf | **Value:** 105500000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

âœ… No critical issues found.

---

## ğŸ” Clear Signing Audit Report

### ğŸ“‹ Function: `deposit()`

**Selector:** `0xd0e30db0`

> **Declared Intent:** "Wrap"

This intent is accurate and concise â€” the function accepts native ETH (payable) and credits an internal balance (WETH-style wrap); no spelling/grammar issues.

---

### 1ï¸âƒ£ Source summary (what the contract does)

The implemented function:
- Is payable and increments `balanceOf[msg.sender]` by `msg.value`.
- Emits `Deposit(msg.sender, msg.value)`.
Behavior: user sends native ETH with the transaction; the contract records that ETH under the user's internal token balance (typical WETH deposit).

Receipt logs in the samples show the event signature 0xe1fffcc4..., which corresponds to the standard WETH Deposit(address,uint256) event â€” matching the source behavior.

---

### 2ï¸âƒ£ Critical Issues

> ğŸ”´ **CRITICAL** - Issues that could lead to users being deceived or losing funds

âœ… No critical issues found

Rationale (concise):
- The contract is payable and converts msg.value into internal token balance; ERC-7730 declares intent "Wrap" which matches actual behavior.
- There are no input parameters omitted from the metadata that exist in the ABI (the function has no ABI parameters besides being payable).
- The missing display of the amount/msg.value is a UI/display omission (not a wrong token/amount or mismatched recipient) and therefore not a critical issue per the rules.

---

### 3ï¸âƒ£ Missing Parameters

> âš ï¸ *Parameters present in ABI but NOT shown to users in ERC-7730*

**âœ… All ABI parameters are covered**

Note: The function has no ABI input parameters. The only runtime value is `msg.value` (tx value), which is not an ABI parameter â€” it can be displayed via `"path": "@.value"` but is not required by the "missing ABI parameter" rule.

---

### 4ï¸âƒ£ Display Issues

> ğŸŸ¡ **Issues with how information is presented to users**

- No amount shown:
  - The ERC-7730 format includes only `{"intent":"Wrap","fields":[]}` â€” no field displays the ETH amount (msg.value). Users seeing the clear-signing display will only see "Wrap" and no amount/value details.
  - Impact: non-critical. Users still control the tx value in their wallet and can see the ETH they sent there, but the clear-signing UI won't summarize the key amount for this selector.
  - Fix: add a field with `path: "@.value"` and format `"amount"`, or add a `tokenAmount` field referencing a nativeCurrencyAddress sentinel so ETH/WETH is shown clearly.
- Token vs native: ambiguous token labeling
  - The function wraps native ETH into contract internal balance (WETH-like). The current metadata does not show the resulting token (WETH) or clarify that the asset credited is the contract token. This can confuse users who expect to see "Receive WETH" vs "Sent ETH".
  - Suggestion: show both sides explicitly: "Send: ETH (msg.value)" and "Receive: WETH (contract token)" if applicable.
- No field labels or definitions:
  - The metadata uses no definitions/constants or `$ref`s; this is fine but minimal. Consider adding a `tokenAmount` definition with `nativeCurrencyAddress` if wallets expect to render native ETH properly.
- Event transparency:
  - Receipt logs show Deposit(address,uint256) events; current metadata doesn't map to those logs. Not required, but mapping would make the display richer.
- Minor: Currently intent string is short but adequate â€” no grammar issues.

---

### 5ï¸âƒ£ Transaction Samples â€” What Users See vs What Actually Happens

(Analyzed 3 samples; omitted hash/block/from/value per report instructions.)

#### ğŸ“ Transaction 1 (sample 1)
User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | Amount sent (msg.value) not shown |
| Fields | none | Which token the user receives (internal WETH balance) not shown |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit | Contract emitted Deposit(indexed sender, amount) â€” user's internal WETH balance increased by msg.value | âŒ Not shown by metadata |
| Transfer-like outcome | User's `balanceOf` in contract increased by same amount | âŒ Not shown by metadata |

#### ğŸ“ Transaction 2 (sample 2)
User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | Amount (msg.value) omitted |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit | Deposit event with the incoming amount in data | âŒ Not shown |
| State change | balanceOf increased for tx sender | âŒ Not shown |

#### ğŸ“ Transaction 3 (sample 3)
User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | No explicit "Receive WETH" line |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit | Standard Deposit event emitted by WETH-like contract | âŒ Not shown |
| Balance update | Internal balance of sender updated | âŒ Not shown |

Summary: In all samples the metadata shows only the high-level intent "Wrap"; actual logs confirm ETH was deposited and internal balances credited. The metadata does not display the amounts or token labels.

---

### 6ï¸âƒ£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 5/10 | Intent correct but metadata is minimal: it does not show amounts (msg.value) or label the resulting token (WETH/internal balance). |
| **Security Risk** | ğŸŸ¢ Low | No incorrect token/amount display, no missing recipient/approval surprises; users are not being deceived about final balances. |

#### ğŸ’¡ Key Recommendations
- Add an amount field for msg.value:
  - Add a field: `{"path":"@.value","label":"Amount","format":"amount"}` so the UI displays the ETH sent.
- Clarify receive asset (WETH/internal token):
  - Add a field showing the resulting token credited (e.g., tokenAmount referencing the contract token address), or include text like "Receive: WETH (contract token)".
  - If wallet UI supports it, use a tokenAmount with `nativeCurrencyAddress` only if you intend to show native ETH â€” otherwise reference the contract token address to show the correct ERC20.
- Optional: link to the Deposit event:
  - Add a mapping or note that the contract emits Deposit(address,uint256) so wallets can display the on-chain event if they choose.
- Keep intent "Wrap" but enrich fields to show both in/out for better UX.

---

If you want, I can produce a concrete ERC-7730 JSON snippet that shows msg.value and the receive token (WETH) fields to copy into the registry.

---

