# ğŸ“Š Clear Signing Audit Report

**Generated:** 2025-10-28 11:18:18

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | ğŸ”´ Critical | ERC-7730 metadata provides no fields (empty fields array) and therefore does not display the transac... | [View](#selector-d0e30db0) |

---

## ğŸ“ˆ Statistics

| Metric | Count |
|--------|-------|
| ğŸ”´ Critical | 1 |
| ğŸŸ¡ Major | 0 |
| ğŸŸ¢ Minor | 0 |
| âœ… No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>ğŸ“‹ ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>ğŸ” Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x15656d68856772c1b8559dc48dbe0032be6ef1a7108d5c74159f11cc32349210`

**Block:** 23675562 | **From:** 0x798c4d95f5c186ea4fa2838cda5e797a28f982e6 | **Value:** 1500000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0x812c8aa2ae34dacc6441543954d0e9fdd09fc54331d85c0d285130f97dc7bf59`

**Block:** 23675560 | **From:** 0xf279357d8b7fb58486ed5978f20cd079bbeb8fdb | **Value:** 2300000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0x95d07631e36694b0c6dae7bfdcf5c0a0e7fe6b948c70f0d194ac81672bcf7c42`

**Block:** 23675557 | **From:** 0xf1baa1b359179fda71d6cc0ffbf4a8ac7058eef2 | **Value:** 65000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0x31cf4b9eda8ebf5d7b91dcd81abf32bf657342711a53bf13f970924c8eed7fce`

**Block:** 23675556 | **From:** 0x1346d9c6315f6c23fe280b49ef215aebd49338b2 | **Value:** 2000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0xad5ec698c993f547805ee3a07db59f0920aa33a620492839c3d7ec95a35f203a`

**Block:** 23675554 | **From:** 0x1346d9c6315f6c23fe280b49ef215aebd49338b2 | **Value:** 15000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

## ğŸ” Clear Signing Audit Report

### ğŸ“‹ Function: `deposit()`

**Selector:** `0xd0e30db0`

---

### 1ï¸âƒ£ Intent Analysis

> **Declared Intent:** "Wrap"

Assessment: The intent "Wrap" is accurate for this function (it is a payable deposit that increments the caller's WETH-style balance); wording is short but clear â€” no spelling/grammar issues.

---

### 2ï¸âƒ£ Critical Issues

> ğŸ”´ **CRITICAL** - Issues that could lead to users being deceived or losing funds

- ERC-7730 metadata provides no fields (empty fields array) and therefore does not display the transaction's native ETH input (msg.value). deposit() is payable and the contract consumes msg.value and credits balanceOf[msg.sender], so the user is effectively sending native ETH. Not showing msg.value is a critical omission because the user will not see the final IN amount (native ETH) in the clear-signing display.
- There is no nativeCurrencyAddress or equivalent mapping in the metadata, and no field referencing @.value or a tokenAmount with native ETH sentinel. As a result the display cannot represent the incoming asset as native ETH (or show it as ETH) â€” the on-chain action (receipt logs emitting Deposit(amount)) will not be reflected as "You are sending X ETH".

Why this is critical:
- The function actively transfers native ETH from the caller (msg.value) into contract state (balanceOf) and emits Deposit events (receipt_logs). The display must show that ETH is being sent (amount + currency). The present format shows no such information â€” a normal user would be surprised and could be misled about what they are actually sending.

(Other checks: no broken $ref, no ABI parameter mismatches â€” the function has no input params; the only critical gap is missing native ETH display.)

---

### 3ï¸âƒ£ Missing Parameters

> âš ï¸ *Parameters present in ABI but NOT shown to users in ERC-7730*

| Parameter | Why It's Important | Risk Level |
|-----------|-------------------:|:---------:|
| tx.value (msg.value) | This is the amount of native ETH the user is sending; deposit() uses it to credit balanceOf[msg.sender] | ğŸ”´ High |

Note: The function has no ABI parameters, but tx.value is material and must be surfaced in UI/clear-signing metadata. Because it's omitted, the user will not see the exact amount/currency they are sending.

---

### 4ï¸âƒ£ Display Issues

> ğŸŸ¡ **Issues with how information is presented to users**

- Missing amount display: fields array is empty â€” no @.value or tokenAmount shown.
- Missing native ETH sentinel / nativeCurrencyAddress: metadata does not provide a way to render token amounts as native ETH. If display used a tokenAmount format it must include nativeCurrencyAddress (via definition or inline params) to show ETH correctly.
- Minimal labeling: intent "Wrap" is short but the UI should clarify "Wrap ETH â†’ WETH" or similar.
- No confirmation of token credited: users may expect WETH balance increase; the metadata does not show the resulting asset (WETH) or its amount/recipient.
- No definitions/constants referenced; because fields are empty there are no $ref resolution issues â€” but also no actual information is surfaced.
- Spelling/grammar: none found.

Display-edge-case note:
- The contract action is native ETH deposit (msg.value). ERC-7730 currently does not use any user-supplied tokenPath parameter (there are no input params). Because the display relies on fields, it must show @.value directly or use a tokenAmount with a native sentinel â€” otherwise the displayed token/amount will be absent, making the "Wrap" claim opaque.

---

### 5ï¸âƒ£ Transaction Samples - What Users See vs What Actually Happens

(Analyzed 3 samples from provided list. Per instructions, hashes/blocks/values are not repeated here.)

#### ğŸ“ Transaction 1

User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | â€” |
| Amount | (nothing; no fields) | msg.value (native ETH amount sent) |
| Asset | (nothing specific) | native ETH â†’ contract balanceOf credited (WETH-style) |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:---------:|
| Deposit event | Contract emitted Deposit(address user, uint256 amount) matching the tx value | âŒ No â€” metadata lacks field showing amount |
| Balance update | balanceOf[msg.sender] increased on-chain (WETH balance) | âŒ No â€” not shown explicitly |

#### ğŸ“ Transaction 2 (another sample)

User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | â€” |
| Amount | (nothing) | msg.value (native ETH amount) |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:---------:|
| Deposit event | Contract emitted Deposit(user, amount) | âŒ No |
| (No ERC-20 Transfer logged in provided sample) | balance credited internally | âŒ No |

#### ğŸ“ Transaction 3 (another sample)

Same pattern: the receipt logs show Deposit events (amount matching msg.value) but ERC-7730 fields are empty so the clear-signing display would not show the ETH amount or resulting WETH credit.

---

### 6ï¸âƒ£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 3/10 | Intent "Wrap" is correct but critical runtime detail (msg.value/native ETH amount and credited WETH) is not displayed at all. |
| **Security Risk** | ğŸŸ¡ Medium | Omitting the native ETH amount is likely to confuse users and may lead to accidental ETH transfers without clear confirmation; it is not an exploit but is a high-visibility UX risk that could result in user surprise or misplaced trust. |

#### ğŸ’¡ Key Recommendations
- Add explicit display of the incoming native ETH amount:
  - Minimal fix: add field {"path":"@.value","label":"Amount","format":"amount"} so msg.value is shown as ETH.
  - Preferred: add a tokenAmount entry with params.tokenPath pointing to WETH/native sentinel and include nativeCurrencyAddress (via definitions/constants) so UI can represent "ETH" properly and show correct decimals.
- Clarify the intent/label: change or extend intent to "Wrap ETH â†’ WETH" and include a field indicating the destination (balanceOf[msg.sender], i.e., credited to caller).
- Optionally show the on-chain event/result: include a "Result" or "Credit" field that indicates the contract credited the caller with WETH of amount X (derived from msg.value), so the user sees both the outgoing asset (ETH) and the resulting asset (WETH).
- If using a tokenAmount definition from shared definitions, ensure that the definition includes nativeCurrencyAddress (e.g., $.metadata.constants.addressAsEth) so ETH is rendered as ETH and not as an arbitrary ERC-20.

---

Summary: The metadata's intent ("Wrap") matches the function, but the display omits the core on-chain action â€” the native ETH sent (msg.value) and the credited balance. Because deposit() is payable and receipt_logs show Deposit events matching tx value, this omission is critical: the clear-signing UI must show the ETH amount/currency to avoid user surprise. Implement the fixes above to make the display accurate and safe.

---

