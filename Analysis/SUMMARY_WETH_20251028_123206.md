# ğŸ“Š Clear Signing Audit Report

**Generated:** 2025-10-28 12:32:06

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | ğŸ”´ Critical | ERC-7730 metadata contains no fields (empty "fields": []), so the payable native ETH amount (msg.val... | [View](#selector-d0e30db0) |

---

## ğŸ“ˆ Statistics

| Metric | Count |
|--------|-------|
| ğŸ”´ Critical | 1 |
| ğŸŸ¡ Major | 0 |
| ğŸŸ¢ Minor | 0 |
| âœ… No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>ğŸ“‹ ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>ğŸ” Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x024141b0c404b1222633939772cb9fab1c0dcf68bafd5357a480b5f5440ce24f`

**Block:** 23675932 | **From:** 0x057bf018b1f3a1bf80faefdef2691104e6f96c38 | **Value:** 242024902579440

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0xa0a2c0b24e5c6ca614bdcfef2589e64bbab56b9297c3a827343f00d71ad815ce`

**Block:** 23675932 | **From:** 0x1346d9c6315f6c23fe280b49ef215aebd49338b2 | **Value:** 17000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0x4198908bb9bc212c2e982e2368400b702d906551347c026e65fc4f0964546373`

**Block:** 23675929 | **From:** 0xb90e27a2029834ae6998779ddb468bd834de1989 | **Value:** 44995000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0x9dfd3bd9a7d6bef64455ab6480a1b3a7e9b02be5033137b4e3e978f3582c528b`

**Block:** 23675922 | **From:** 0x176a283c22febd9f30a7593c70f0b4767d21c640 | **Value:** 3886430876500688

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0xee8836a8035988bc8029fa120cd1e9e11774fd987f89301758a3b915812d4794`

**Block:** 23675908 | **From:** 0xf0efedb980345df4fc1175432b6c968efb221f80 | **Value:** 150000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

## ğŸ” Clear Signing Audit Report

### ğŸ“‹ Function: `deposit()`

**Selector:** `0xd0e30db0`

---

### 1ï¸âƒ£ Intent Analysis

> **Declared Intent:** *"Wrap"*

The declared intent "Wrap" is appropriate (this is WETH-style deposit that wraps native ETH into token balances), but the intent could be clearer (e.g., "Wrap ETH â†’ WETH").

---

### 2ï¸âƒ£ Critical Issues

> ğŸ”´ **CRITICAL** - Issues that could lead to users being deceived or losing funds

- ERC-7730 metadata contains no fields (empty "fields": []), so the payable native ETH amount (msg.value) sent by the user is not displayed. This is critical because the function is payable and the value being transferred is the main piece of information a user expects to see when wrapping ETH.
- There is no nativeCurrencyAddress or @.value reference anywhere in the provided format, so native ETH cannot be shown as a tokenAmount. For a payable deposit() this means the display will not show the actual incoming ETH amount or associate it with native ETH â€” UI will be blind to the transferred asset/value.

(Notes checked: there are no broken $ref paths, no ABI parameter name mismatches, and no conflicts between displayed token addresses and logs.)

---

### 3ï¸âƒ£ Missing Parameters

> âš ï¸ *Parameters present in ABI but NOT shown to users in ERC-7730*

âœ… All parameters are covered (function has no ABI inputs).  
However, msg.value (native ETH sent) is not represented in the metadata fields â€” see critical issues above.

---

### 4ï¸âƒ£ Display Issues

> ğŸŸ¡ **Issues with how information is presented to users**

- No amount field: metadata has empty "fields", so the UI will show only intent ("Wrap") and nothing about how much ETH is being deposited.
- Ambiguous label: intent "Wrap" is short; better to be explicit ("Wrap ETH â†’ WETH") to avoid confusion.
- Native ETH sentinel absent: the metadata does not provide nativeCurrencyAddress (or reference to such constant) in any definition, so even if a tokenAmount format were added, it currently cannot identify native ETH vs ERC20.
- Coherence: receipt_logs show a Deposit event (WETH contract) with the depositor and amount in the logs â€” the metadata should map to @.value or a tokenAmount native mapping so what's actually happening on-chain is visible to users.
- No fields means no recipient/amount/asset labels â€” even though recipient is msg.sender (implicit), showing amount and resulting token (WETH) is expected for UX.

Display-edge-case note (non-critical but important): The contract is payable and credits balanceOf[msg.sender] by msg.value; the metadata currently trusts no input parameter (there are none). To avoid user-supplied token-address confusion, use explicit native sentinel or show @.value.

---

### 5ï¸âƒ£ Transaction Samples - What Users See vs What Actually Happens

(Analyzed three samples; omitting tx identifiers per instructions.)

#### ğŸ“ Transaction 1

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | Which asset and how much (no amount shown) |
| Amount | â€” | msg.value (ETH) not displayed |
| Recipient | â€” | Implicit: msg.sender (not shown) |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit (WETH) | Token contract emitted Deposit with depositor and amount (data contains amount) | âŒ No (metadata doesn't expose amount) |
| Balance update | balanceOf[msg.sender] increased by msg.value on contract | âŒ No (not shown) |

#### ğŸ“ Transaction 2

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | Exact ETH amount (missing) |
| Token | â€” | WETH as result not shown |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit (WETH) | Deposit event data includes value minted/credited | âŒ No |
| Sender | depositor address is topic[1] | âŒ Not surfaced in fields |

#### ğŸ“ Transaction 3

Same pattern: user sees only intent; logs show deposit event with amount; UI metadata fails to disclose numeric amount and native ETH identity.

---

### 6ï¸âƒ£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 3/10 | Intent is correct but metadata provides zero fields; native ETH amount (primary info) is missing. |
| **Security Risk** | ğŸŸ¡ Medium | Not showing the ETH amount is likely to confuse users and may lead to accidental overpayment or not understanding what was sent; it does not change on-chain effects but harms user transparency. |

#### ğŸ’¡ Key Recommendations
- Add a field that displays the incoming ETH amount:
  - Minimal: {"path":"@.value","label":"Amount","format":"amount"}
  - Preferable: use tokenAmount with nativeCurrencyAddress sentinel so amount is shown as ETH and converted if UI supports fiat.
    Example: {"path":"@.value","format":"tokenAmount","params":{"tokenPath":"<native sentinel>","nativeCurrencyAddress":["$.metadata.constants.addressAsEth"]}}
- Explicitly show the resulting token (WETH) in the UI (label like "Receive: WETH") or clarify that this call wraps ETH.
- Update the intent label to "Wrap ETH â†’ WETH" and add clear field labels (Amount, From, To) so users see what they send and what they receive.
- If using $ref definitions, ensure definitions/constants include nativeCurrencyAddress and that $ref paths are correct.

---

If you want, I can propose the exact JSON snippet to add to the ERC-7730 metadata (one-line minimal and one-line preferred with native sentinel) so the UI will correctly show msg.value as ETH and label the wrap.

---

