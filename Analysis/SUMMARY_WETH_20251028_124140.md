# ğŸ“Š Clear Signing Audit Report

**Generated:** 2025-10-28 12:41:40

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | ğŸ”´ Critical | ERC-7730 format provides zero fields. deposit() is payable; the metadata therefore does not show msg... | [View](#selector-d0e30db0) |

---

## ğŸ“ˆ Statistics

| Metric | Count |
|--------|-------|
| ğŸ”´ Critical | 1 |
| ğŸŸ¡ Major | 0 |
| ğŸŸ¢ Minor | 0 |
| âœ… No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>ğŸ“‹ ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>ğŸ” Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x452f23f9b91dc2eda80ba27782d5d75e6e657b7d07719155aaf7d37dfae8255c`

**Block:** 23675970 | **From:** 0x93fc7c0841f5d22529078aef01e68e34f9b54bc8 | **Value:** 199999999999992

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0x3ad31e1a0be3282126b1c26f5d706a1ba0bcbebe986475f34bcea700175b5ee2`

**Block:** 23675960 | **From:** 0xba40917080746543702c90a75d2fd36c7f333395 | **Value:** 537000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0xaa588b66d4dddc1a53e60c97ce0ce8805a326b3e804db7ed4122a834e4784721`

**Block:** 23675956 | **From:** 0xcad97616f91872c02ba3553db315db4015cbe850 | **Value:** 3487676963736553472

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0x8ab830ed6d7db90c8824c53545de4231a2316f3884e4e501507148b8346155eb`

**Block:** 23675956 | **From:** 0x40c967bd8f32dda34947d3cc0c094b4c1c52fc34 | **Value:** 9640346779814450

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0x15910d65e5fa0974299b9d1fd1f0843f526e4684eac51637dd56cd1e3011854b`

**Block:** 23675954 | **From:** 0xd71d5c7ad0feeeec6ff138d76c29c55b71038d33 | **Value:** 2414996094522175390

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

## ğŸ” Clear Signing Audit Report

### ğŸ“‹ Function: deposit()

**Selector:** 0xd0e30db0

---

### 1ï¸âƒ£ Intent Analysis

> **Declared Intent:** *"Wrap"*

The declared intent "Wrap" is accurate for this function (it accepts native ETH and credits the caller with an equivalent internal/wrapped balance), but the metadata is minimal and does not present the key facts (ETH sent / WETH received). No spelling/grammar issues.

---

### 2ï¸âƒ£ Critical Issues

> ğŸ”´ **CRITICAL** - Issues that could lead to users being deceived or losing funds

- ERC-7730 format provides zero fields. deposit() is payable; the metadata therefore does not show msg.value (ETH sent). This is critical because msg.value is an input the user must know and the display currently hides it.
- ERC-7730 metadata does not show the WETH token received nor its amount. Final on-chain effect (user receives wrapped token balance / Deposit event) is not represented, so the user may be unaware that native ETH was converted/credited to WETH.
- These are fixable from available inputs (msg.value is part of tx and the target contract is known), so omission is a metadata/display bug â€” but it is critical per native-ETH rules.

No other critical issues found (no broken $ref, no wrong token inversion, no mismatched ABI paths).

---

### 3ï¸âƒ£ Missing Parameters

> âš ï¸ *Parameters present in ABI but NOT shown to users in ERC-7730*

| Parameter | Why It's Important | Risk Level |
|-----------|-------------------:|:----------:|
| msg.value (ETH sent) | This is the actual amount the user pays to deposit() â€” must be visible | ğŸ”´ High |

Note: deposit() has no ABI input parameters, but msg.value is an implicit input that must be surfaced; currently it is not shown.

---

### 4ï¸âƒ£ Display Issues

> ğŸŸ¡ **Issues with how information is presented to users**

- No fields declared: user only sees the intent "Wrap" and nothing else (no amount in, no token out).
- Missing explicit representation that the contract is WETH (0xC02aaa...). The receipt_logs show Deposit events emitted by WETH contract, but metadata doesn't map that to a "receive WETH" line.
- Native ETH handling: function is payable and converts ETHâ†’WETH. ERC-7730 must surface msg.value (via path "@.value" / format "amount") and show resulting WETH (via tokenAmount referencing WETH address or tokenPath). Neither is defined.
- No $ref or definitions are present â€” nothing to reuse; not an error but creates an empty UI.
- UX confusion risk: user may think they are doing a generic "wrap" without seeing amounts, leading to accidental overpayment.
- No spelling/grammar errors but coherence is poor (intent present, details absent).

Display-edge case note: Because the token received (WETH) is implied by the contract address and deposit event, the UI should not rely on user input for token identity. It must hardcode/constant the receiving token as WETH or show "Wrapped ETH (WETH)" tied to the contract.

---

### 5ï¸âƒ£ Transaction Samples - What Users See vs What Actually Happens

(Selecting 3 sample txs from the provided list.)

#### ğŸ“ Transaction 1

User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | Exact ETH amount sent (msg.value) |
| Fields | none | WETH token received and amount |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | Contract (WETH) emitted Deposit(addr, amount) = actual ETH wrapped | âŒ No |
| Internal balance change | balanceOf[msg.sender] increased by msg.value on contract | âŒ No |

Result: User UI shows only "Wrap" â€” actual deposit amount and WETH credit are not displayed.

---

#### ğŸ“ Transaction 2

User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | msg.value (0.537 ETH shown in logs but not in UI) |
| Fields | none | WETH token/amount received |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | WETH Deposit emitted for sender with value 0.537 ETH | âŒ No |

---

#### ğŸ“ Transaction 3

User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | msg.value (3.487... ETH in logs) |
| Fields | none | WETH token/amount received |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | WETH Deposit for the caller, amount equals msg.value | âŒ No |

---

### 6ï¸âƒ£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 2/10 | Intent is correct but metadata lacks any fields to show the actual ETH sent or the WETH received â€” core UX missing. |
| **Security Risk** | ğŸŸ¡ Medium | Not a malicious misrepresentation, but hiding the payment amount and resulting token could cause users to unintentionally send/confirm wrong amounts. This is a usabilityâ†’fund-loss risk.

#### ğŸ’¡ Key Recommendations
- Add explicit amount-in field showing msg.value:
  - e.g. {"path":"@.value","label":"Amount","format":"amount"}
- Add explicit received-token field showing WETH and amount:
  - e.g. {"path":"@.value","label":"Receive","format":"tokenAmount","params":{"tokenAddress":["$.metadata.constants.weth"],"nativeCurrencyAddress":["$.metadata.constants.addressAsEth"]}}
  - Or use tokenPath constant pointing to contract address (0xC02aaa...).
- Add a constant in metadata for WETH address and ensure the UI shows both "ETH (sent)" and "WETH (received)" to avoid confusion.
- If the display system supports a single line, at minimum show: "Send X ETH â†’ Receive X WETH".
- Test with the actual Deposit event and @.value path to ensure amounts line up with receipt logs.

---

If you want, I can produce an updated ERC-7730 format snippet (JSON) that adds the suggested fields and constants for WETH/ETH so the UI will show "Amount (ETH)" and "WETH received" properly.

---

