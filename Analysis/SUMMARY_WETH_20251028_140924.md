# üìä Clear Signing Audit Report

**Generated:** 2025-10-28 14:09:24

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | üü¢ Minor | Problem: ERC-7730 format has "fields": [] (empty). There is no field showing msg... | [View](#selector-d0e30db0) |

---

## üìà Statistics

| Metric | Count |
|--------|-------|
| üî¥ Critical | 0 |
| üü° Major | 1 |
| üü¢ Minor | 0 |
| ‚úÖ No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>üìã ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>üîç Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x198c26a25cafc2eb026cdc6b1ee6c9cce6b99a5757a5ddbd628891ec914c1d92`

**Block:** 23676408 | **From:** 0xc70882fd04799dfa6b72c7bda3068bfd9e11be66 | **Value:** 570000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0x84dfa4e72d6cc72659ba9d785a17e942be00189389b8387421c29aa8a2cfc21b`

**Block:** 23676391 | **From:** 0x6d99ec43e45f862b6742ff04e6476bf4773e54c8 | **Value:** 52000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0x364fd2981e89794cd5d60ea81a7b9e41c66371d8fba6ee38fbce145f4818beee`

**Block:** 23676388 | **From:** 0x683804afccdf61450072105e0e876c48569361fa | **Value:** 78000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0xf660a32fc548ed749f40b153a85ef98d92cd82400c784292a2233a9868e0ae49`

**Block:** 23676382 | **From:** 0xfe0c760cbcb9da239b9ba805f0aeaed3be84f65a | **Value:** 1000844352649550934

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0xd2301fd0da26b59f9d3570ea39b685e9e67762776956034ffdbdbf5b8af4d60d`

**Block:** 23676374 | **From:** 0xe723c40788e8b547d103be0d202437f8922b5594 | **Value:** 17200000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### üìã Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| ‚ùì Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

## üîç Clear Signing Audit Report

### üìã Function: deposit()
Selector: 0xd0e30db0

---

### 1Ô∏è‚É£ Intent Analysis

> **Declared Intent:** "Wrap"

Assessment: The intent "Wrap" is accurate but terse ‚Äî it implies wrapping native ETH into the contract's internal balance (WETH-style deposit). Consider clarifying to "Wrap ETH (deposit)" for users who may not know context. No spelling/grammar errors.

---

### 2Ô∏è‚É£ Critical Issues

> üî¥ **CRITICAL** - Issues that could lead to users being deceived or losing funds

‚úÖ No critical issues found.

Explanation:  
- The contract is payable and the on-chain logs show a Deposit(address,uint256) event matching msg.value for each transaction (receipt_logs entries with signature 0xe1fffcc4...). There is no evidence of inverted tokens, wrong amounts, wrong recipient addresses, or approvals that would cause users to lose tokens or receive wrong tokens.
- The ERC-7730 metadata declares intent "Wrap" and contains no fields. That is a display omission, but it does not misreport which token/address/amount was actually moved on-chain. The transaction receipts show the actual amounts and the Deposit event. Under the conservative criticality rules, this is not a misreport of final tokens/amounts ‚Äî it's a missing presentation detail.

However ‚Äî note for implementers: because deposit() is payable and the metadata contains no field showing msg.value or a tokenAmount with nativeCurrencyAddress, UIs relying solely on this metadata may not explicitly show the ETH amount being wrapped. This is a display deficiency (covered below), not a mismatch between displayed and actual on-chain effects.

---

### 3Ô∏è‚É£ Missing Parameters

> ‚ö†Ô∏è *Parameters present in ABI but NOT shown to users in ERC-7730*

The deposit() ABI has no input parameters (it is payable, no explicit args). Therefore:

‚úÖ All ABI parameters are covered (there are none).

Note: msg.value is not an ABI parameter but is an important transaction value that should be displayed via metadata (e.g., path "@.value") ‚Äî this is a display issue, not a missing ABI parameter.

---

### 4Ô∏è‚É£ Display Issues

> üü° **Issues with how information is presented to users**

1. No amount displayed
   - Problem: ERC-7730 format has "fields": [] (empty). There is no field showing msg.value (the amount of ETH the user is sending/wrapping) nor a tokenAmount field referencing native ETH.
   - Impact: A UI that only shows the ERC-7730 metadata may only show the intent "Wrap" without the ETH amount being wrapped. Users could be unsure or surprised by the amount being sent if the UI doesn't separately show tx.value.
   - Severity: Medium (confusion/risk of accidental overpayment). Not a mismatch of on‚Äëchain amounts.

2. Native ETH handling not represented
   - Problem: For payable functions that move ETH, metadata should either present the amount via {"path":"@.value","format":"amount"} or a tokenAmount referencing the nativeCurrencyAddress sentinel in definitions. Neither is present.
   - Suggested fix examples (see Recommendations).

3. Intent label could be clearer
   - "Wrap" is correct but minimal. Prefer "Wrap ETH ‚Üí WETH (deposit)" or similar to make the direction explicit.

4. No post-action balance or token credit display
   - Problem: The metadata does not indicate that the sender's contract balance (an internal ERC-20-like balanceOf) is incremented; showing the resulting token (WETH) credit would improve user clarity.
   - Suggestion: Add a field describing the resulting wrapped token credit (if desired and possible).

5. No $ref or definitions issues found
   - The provided format doesn't reference broken $ref entries; there are simply no fields or references.

---

### 5Ô∏è‚É£ Transaction Samples - What Users See vs What Actually Happens

(We analyze 3 samples from the input; we DO NOT repeat tx hash/block/from/value as requested.)

#### üìù Transaction 1 (sample with value 0.57 ETH)

User Intent (from ERC-7730):

| Field | ‚úÖ User Sees | ‚ùå Hidden / Missing |
|-------|-------------|---------------------|
| Intent | "Wrap" | Amount being wrapped (0.57 ETH) |
| Fields | none | token credited (balanceOf[msg.sender]) |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:---------:|
| Deposit (Unknown signature 0xe1fffcc4...) | Event emitted with indexed address = sender; data = 0x...07e90bfae1f90000 (0.57 ether) | ‚ùå Not shown by current ERC-7730 fields (no field) |
| Balance change (on-chain state) | contract's balanceOf[sender] increased by msg.value | ‚ùå Not shown by metadata |

Notes: The receipt log shows the deposit event and exact amount. ERC-7730 metadata does not expose the amount via fields, so a UI that relies only on this metadata will omit the amount.

#### üìù Transaction 2 (sample with value 0.052 ETH)

User Intent (from ERC-7730):

| Field | ‚úÖ User Sees | ‚ùå Hidden / Missing |
|-------|-------------|---------------------|
| Intent | "Wrap" | Amount being wrapped (0.052 ETH) |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:---------:|
| Deposit event | data contains 0x...00b8bdb978520000 (0.052 ETH) | ‚ùå Not shown by current metadata |

#### üìù Transaction 3 (sample with value 1.000844352649550934 ETH)

User Intent (from ERC-7730):

| Field | ‚úÖ User Sees | ‚ùå Hidden / Missing |
|-------|-------------|---------------------|
| Intent | "Wrap" | Amount being wrapped (1.0008443... ETH) |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:---------:|
| Deposit event | data = 0x...0de3b6a2d321dc56 (1.000844352649550934 ETH) | ‚ùå Not shown by current metadata |

Summary: All sampled transactions executed deposit() with ETH and emitted the expected Deposit event; metadata does not include fields to show msg.value or tokenAmount so UI may hide the amount unless it shows tx.value elsewhere.

---

### 6Ô∏è‚É£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 3/10 | Metadata declares the correct high-level intent "Wrap" but provides no fields to show amounts or resulting token balances; essential UX information (msg.value) is missing. |
| **Security Risk** | üü° Medium | On-chain behavior is straightforward and correct (no token/address mismatch), but omission of amount display can cause user confusion and accidental overpayment. There is no evidence of funds being sent to a wrong address. |

#### üí° Key Recommendations
1. Display the sent ETH amount explicitly:
   - Add a field that shows msg.value. Minimal snippet:
     {"path":"@.value","label":"Amount to wrap","format":"amount"}
   - Or, show as a tokenAmount using nativeCurrencyAddress sentinel:
     {
       "path":"@.value",
       "label":"Amount",
       "format":"tokenAmount",
       "params": {
         "tokenPath": "<native-sentinel-or-constant>",
         "nativeCurrencyAddress": ["$.metadata.constants.addressAsEth"]
       }
     }
   - Preferred: use {"path":"@.value","format":"amount"} since deposit() has no ABI inputs.

2. Make intent clearer:
   - Change intent from "Wrap" to "Wrap ETH ‚Üí WETH (deposit)" or add a descriptive label field so users understand direction and token type.

3. (Optional) Show resulting credit:
   - If desired, add a descriptive field: "Receive: WETH (balanceOf credited to caller)" ‚Äî either via a tokenAmount that references the known WETH address or via a static label if WETH token address is known in metadata.constants.

4. Ensure nativeCurrencyAddress constant (if you use tokenAmount) is present and correct:
   - If you use tokenAmount and want automatic ETH display, include metadata.constants.addressAsEth (or other sentinel) and reference it via nativeCurrencyAddress in definitions.

5. Keep events in mind:
   - The contract emits Deposit(address,uint256) (sig 0xe1fffcc4...). While events are only for auditing, consider mapping the Deposit event to a user-friendly display if the UI supports deriving amounts from logs.

---

If you want, I can produce a minimal ERC-7730 snippet (JSON) that fixes the display (adds @.value amount field and a clearer intent string) ready to drop into the registry. Which format do you prefer: simple amount field, or tokenAmount with nativeCurrencyAddress support?

---

