# ğŸ“Š Clear Signing Audit Report

**Generated:** 2025-10-28 14:17:58

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | ğŸ”´ Critical | The ERCâ€‘7730 metadata's "fields" array is empty. This is a payable function that relies on msg.value... | [View](#selector-d0e30db0) |

---

## ğŸ“ˆ Statistics

| Metric | Count |
|--------|-------|
| ğŸ”´ Critical | 1 |
| ğŸŸ¡ Major | 0 |
| ğŸŸ¢ Minor | 0 |
| âœ… No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>ğŸ“‹ ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>ğŸ” Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x3281d246dc5706b19bf89f965870a6d18b3e4ee8ff7b72d9fc1c55c6850d8099`

**Block:** 23676452 | **From:** 0x267d9e989129510532dfb9ded7bd10a4f2c29e30 | **Value:** 1901000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0xa925f95d7e3c8853b56ce29be4b2ee41774422a9b9d99538a03a5402c658fadc`

**Block:** 23676449 | **From:** 0x1bb35a7c55e90188e3cf31034c80a884c1edd922 | **Value:** 1500000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0x460249af525bb2da6825b5b9b208d675f7da0c6f7e541f076fb004b57f462edc`

**Block:** 23676448 | **From:** 0x51b762bdb06786a79bf5c356203ae7746f8f46e1 | **Value:** 2500000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0x094300cec09988d9a353387418cdc63476881746756714adcb20f68ef19d8678`

**Block:** 23676446 | **From:** 0x1bb35a7c55e90188e3cf31034c80a884c1edd922 | **Value:** 1499999900000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0xbaf2d9c7b3bacc43dac589685d1f52d068f6ac9cf03aa733b04f32be1164965d`

**Block:** 23676446 | **From:** 0xcbdcaa49d52e9a055afa6f1c144631bdc083ee20 | **Value:** 150000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

## ğŸ” Clear Signing Audit Report

### ğŸ“‹ Function: `deposit()`

**Selector:** `0xd0e30db0`

---

### 1ï¸âƒ£ Intent Analysis

> **Declared Intent:** *"Wrap"*

The intent "Wrap" is accurate and concise â€” deposit() is the standard payable WETH-style function that accepts native ETH and credits the sender with an onâ€‘contract token balance (wraps ETH).

---

### 2ï¸âƒ£ Critical Issues

> ğŸ”´ **CRITICAL** - Issues that could lead to users being deceived or losing funds

- The ERCâ€‘7730 metadata's "fields" array is empty. This is a payable function that relies on msg.value (native ETH). Because there are no fields showing the transaction value, the UI will not show the ETH amount the user is sending. Per the spec rules, a payable function that accepts native ETH must expose msg.value (e.g., via path "@.value") or a tokenAmount with nativeCurrencyAddress â€” absence is CRITICAL.
- The metadata does not display what the user receives (the wrapped token credit). Users will send ETH but see no indication of the received token/credited balance. That omission increases the chance users are surprised by the outcome.

Why these are critical: a normal user would reasonably expect to see the amount of ETH they are sending and the wrapped token they will receive. Hiding both is likely to shock users and can lead to accidental overpayment or confusion.

âœ… No other critical issues found: there are no broken $ref references, no missing ABI input parameters (the function has no inputs), and logs show the expected Deposit event.

---

### 3ï¸âƒ£ Missing Parameters

> âš ï¸ *Parameters present in ABI but NOT shown to users in ERC-7730*

| Parameter | Why It's Important | Risk Level |
|-----------|-------------------|:----------:|
| msg.value (implicit) | Shows how much native ETH the user is sending to deposit() | ğŸ”´ High |

Note: The function has no explicit ABI inputs; the implicit native value (msg.value) must be surfaced. All explicit ABI parameters (none) are covered.

---

### 4ï¸âƒ£ Display Issues

> ğŸŸ¡ **Issues with how information is presented to users**

- Empty fields array: no display of amount in or token out. For a payable deposit(), the display must show msg.value or equivalent tokenAmount with nativeCurrencyAddress.
- No nativeCurrencyAddress / tokenAmount configuration: metadata does not include a definition referencing native ETH sentinel or WETH token, so even tokenAmount style displays cannot show ETH correctly.
- Missing explicit "Receiving token" display: the contract credits balanceOf[msg.sender] (WETH balance). The display should clarify the user will receive wrapped ETH (WETH) credited to their balance.
- Recommendation: tokenPath should not rely on user input here (there are no inputs) â€” instead, hardcode or use metadata constant for the receiving token (WETH) and ensure nativeCurrencyAddress is present for ETH display.
- No spelling/grammar issues observed (intent label "Wrap" is fine).

Suggested fixes (concrete):
- Add msg.value amount field:
  {"path":"@.value","label":"ETH to deposit","format":"amount"}
- Show receiving token (tokenAmount) referencing native ETH or explicit WETH address:
  {"path":"_creditedAmount","label":"You will receive","format":"tokenAmount","params":{"tokenPath":"$.metadata.constants.wrappedToken","nativeCurrencyAddress":["$.metadata.constants.addressAsEth"]}}
- Add metadata constant:
  "metadata": { "constants": { "addressAsEth": "0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE", "wrappedToken": "0xC02aaa39b223FE8D0A0e5C4F27eAD9083C756Cc2" } }

Edge-case note: The contract emits Deposit events with the amount and indexed sender (receipt_logs confirm). Even though logs exist, user-facing metadata must reflect msg.value.

---

### 5ï¸âƒ£ Transaction Samples - What Users See vs What Actually Happens

(Will analyze 3 transactions from samples; per instructions, NOT including tx hash/block/from/value fields.)

#### ğŸ“ Transaction 1

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Amount | No amount field (nothing shown) | msg.value (ETH sent) |
| Intent | "Wrap" (metadata intent) | Which token is received (WETH) and the credited amount |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit(address,uint256) | Contract emitted Deposit indexed to sender with the amount (msg.value) | âŒ Not shown in metadata |
| State change | balanceOf[msg.sender] increased by msg.value | âŒ Not shown |

Result: The transaction actually deposited native ETH and credited the sender; UI would show "Wrap" but not the ETH amount nor the received wrapped token amount.

#### ğŸ“ Transaction 2

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Amount | Nothing shown | msg.value (ETH) |
| Receiving token | Not shown | credited WETH balance |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | Deposit emitted with amount | âŒ No |
| balanceOf update | Sender's balance increased | âŒ No |

#### ğŸ“ Transaction 3

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Any fields | None | msg.value and resulting wrapped token credit |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | Contract recorded deposit event and amount | âŒ No |
| On-chain balance | balanceOf increment | âŒ No |

Summary of samples: All show the same pattern â€” actual deposit events and balance increments occur on-chain, but ERCâ€‘7730 metadata does not display amount in or what is received.

---

### 6ï¸âƒ£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 2/10 | Intent is correct ("Wrap") but essential fields (msg.value and receiving token) are missing â€” major coverage gap. |
| **Security Risk** | ğŸ”´ High | Users can send native ETH without seeing the amount or what they will receive; this is a serious UX/financial risk (surprise transfers). |

#### ğŸ’¡ Key Recommendations
- Immediately update the ERCâ€‘7730 format for selector 0xd0e30db0 to include:
  1. An amount field exposing msg.value: {"path":"@.value","label":"ETH to deposit","format":"amount"}.
  2. A receiving tokenAmount field that indicates the wrapped token and credited amount. Use a metadata constant for the wrapped token (contract address) and include nativeCurrencyAddress if representing ETH.
- Add metadata constants for native ETH sentinel and the wrapped token address (WETH) and reference them in the field params so UIs render ETH vs ERC20 correctly.
- Consider adding a short label/description or warning: "This will deposit native ETH and credit you with WETH (balance on this contract)" so users are not surprised.

---

If you want, I can produce a minimal patch to the ERCâ€‘7730 JSON (exact fields + constants) that you can drop into the registry to fix the display for deposit().

---

