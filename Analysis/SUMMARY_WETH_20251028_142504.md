# ğŸ“Š Clear Signing Audit Report

**Generated:** 2025-10-28 14:25:04

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | ğŸ”´ Critical | ERC-7730 metadata has an empty fields array for a payable function that consumes msg.value; there is... | [View](#selector-d0e30db0) |

---

## ğŸ“ˆ Statistics

| Metric | Count |
|--------|-------|
| ğŸ”´ Critical | 1 |
| ğŸŸ¡ Major | 0 |
| ğŸŸ¢ Minor | 0 |
| âœ… No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>ğŸ“‹ ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>ğŸ” Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x663b8164a3a63655ce545a1ceaac7eb5f3b232fb873dd3f3c5f291eec7f80af7`

**Block:** 23676487 | **From:** 0x1daf53e752ad80c38a5653c9c5e2ab8c16cdcbd0 | **Value:** 685000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0x844178c8ee068ad29722b4591c2d970b25f806b4ce11d945cdffba8b03b22d06`

**Block:** 23676479 | **From:** 0x4339faeac769054857611920358d4b1ab5ee83aa | **Value:** 13100000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0xbfeeeec6a2ce6b50ec1bd7963bf2e268f56aac2e2ffcf918cd7ed8053bc961eb`

**Block:** 23676459 | **From:** 0x5b6bac3ee2f2f13d4294f18237de0d072640e65c | **Value:** 400000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0x3281d246dc5706b19bf89f965870a6d18b3e4ee8ff7b72d9fc1c55c6850d8099`

**Block:** 23676452 | **From:** 0x267d9e989129510532dfb9ded7bd10a4f2c29e30 | **Value:** 1901000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0xa925f95d7e3c8853b56ce29be4b2ee41774422a9b9d99538a03a5402c658fadc`

**Block:** 23676449 | **From:** 0x1bb35a7c55e90188e3cf31034c80a884c1edd922 | **Value:** 1500000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

## ğŸ” Clear Signing Audit Report

### ğŸ“‹ Function: deposit()

**Selector:** 0xd0e30db0

---

### 1ï¸âƒ£ Intent Analysis

> **Declared Intent:** *"Wrap"*

The declared intent "Wrap" is appropriate and concise (no spelling/grammar issues); however the metadata fails to show the essential amounts and token directions that make that intent meaningful to users.

---

### 2ï¸âƒ£ Critical Issues

> ğŸ”´ **CRITICAL** - Issues that could lead to users being deceived or losing funds

- ERC-7730 metadata has an empty fields array for a payable function that consumes msg.value; there is no field showing the ETH amount the user sends. For a payable deposit(), not showing @.value is a critical omission â€” users will not see how much native ETH they are about to send.
- The display does not show the resulting token credited (WETH). The function wraps ETH (increments balanceOf[msg.sender]) but the format shows no outgoing token amount or token identifier; users may not realize they are converting ETH â†’ WETH.

Why critical: msg.value is available for display (@.value). The missing information is obtainable and its absence can meaningfully shock a normal user (they won't be shown the ETH they are sending nor the WETH they receive).

---

### 3ï¸âƒ£ Missing Parameters

> âš ï¸ Parameters present in ABI but NOT shown to users in ERC-7730

| Parameter | Why It's Important | Risk Level |
|-----------|-------------------:|:----------:|
| @.value (msg.value) | This is the ETH the user is sending into deposit(); must be shown so user knows amount they will spend. | ğŸ”´ High |
| (implicit) receiving token = WETH | deposit() mints/increments WETH balanceOf[msg.sender]; showing the resulting token (WETH) is important for user understanding. | ğŸ”´ High |

âœ… No ABI input parameters are omitted (function has no explicit inputs), but the special transaction field msg.value is not represented in display.

---

### 4ï¸âƒ£ Display Issues

> ğŸŸ¡ Issues with how information is presented to users

- Empty fields array: no amount or token fields are presented. For a payable "Wrap" action this is insufficient.
- Missing explicit "Send: ETH" and "Receive: WETH" lines â€” the metadata should show both sides of the wrap.
- No constants/definitions for nativeCurrencyAddress or WETH token address are provided or referenced, so even if a tokenAmount field were added it has no guidance for displaying native ETH vs ERC20.
- No $ref problems detected (there are no $refs), but absence of definitions/constants makes a correct token display impossible.
- Minor coherence note: intent "Wrap" is OK but without fields the intent is not actionable (user can't verify amounts).

Display-edge-case note: The contract actually uses msg.value (native ETH) and credits balanceOf (WETH). The current metadata trusts no user input (there is none) but also fails to show the native ETH; this is a medium/high display mismatch and should be fixed by using @.value and a hardcoded WETH tokenPath or a proper native sentinel.

---

### 5ï¸âƒ£ Transaction Samples - What Users See vs What Actually Happens

(Analyzed 3 samples from provided list)

#### ğŸ“ Transaction 1 (sample 1)

User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden / Missing |
|-------|-------------|--------------------|
| Intent | "Wrap" (label only) | No amount shown |
| Amount | â€” (no fields) | ETH amount (msg.value) not shown |
| Receive token | â€” (no fields) | WETH credited to user not shown |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | deposit(address: user, amount: 0x09819bdee7248000 == tx value) | âŒ No |
| State change | balanceOf[msg.sender] increased by same amount (WETH balance) | âŒ No |

Conclusion: User saw only "Wrap" but did not see the ETH amount sent or WETH credited.

---

#### ğŸ“ Transaction 2 (sample 2)

User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden / Missing |
|-------|-------------|--------------------|
| Intent | "Wrap" | No amount shown |
| Amount | â€” | msg.value (0x2e8a616e8ec000) not shown |
| Receive token | â€” | WETH credited not shown |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | deposit(user, amount) matching tx value | âŒ No |
| State change | balanceOf incremented | âŒ No |

---

#### ğŸ“ Transaction 3 (sample 3)

User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden / Missing |
|-------|-------------|--------------------|
| Intent | "Wrap" | No amount shown |
| Amount/Receive | â€” | msg.value and resulting WETH not shown |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | deposit(user, amount = tx value) | âŒ No |
| State change | balanceOf incremented | âŒ No |

---

### 6ï¸âƒ£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 2/10 | Intent present but no fields to show the critical msg.value or resulting WETH â€” minimal useful info. |
| **Security Risk** | ğŸ”´ Medium-High | Not showing the ETH amount in a payable wrap may shock users and lead to unexpected spending; information is available and should be displayed. |

#### ğŸ’¡ Key Recommendations
- Add an explicit field for the ETH sent:
  - {"path":"@.value","label":"ETH to wrap","format":"amount"}
  This directly shows msg.value to users.
- Add an explicit receive-token field showing WETH credited:
  - Either a tokenAmount field with tokenPath hardcoded to the WETH contract address (in constants) or a tokenAmount definition referencing that constant. Example:
    - Field: {"label":"Receive","$ref":"$.display.definitions.tokenAmount","params":{"amountPath":"@.value","tokenPath":"$.metadata.constants.weth"}}
    - Definition/constants: include weth address and nativeCurrencyAddress if needed.
- Include definitions/constants for nativeCurrencyAddress and WETH address so native vs ERC20 display is unambiguous.
- Keep intent "Wrap" but expand label to "Wrap ETH â†’ WETH" or similar for clarity.
- Optionally show a brief note that deposit() increases WETH balanceOf and emits a Deposit event (so users understand no ERC20 Transfer log may appear).

---

If you want, I can produce the exact JSON snippet to patch the ERC-7730 metadata (fields + definitions + constants) that will correctly show ETH in and WETH out for this deposit() function.

---

