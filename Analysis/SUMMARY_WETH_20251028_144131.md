# ğŸ“Š Clear Signing Audit Report

**Generated:** 2025-10-28 14:41:31

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | ğŸ”´ Critical | ERC-7730 metadata's fields array is empty while deposit() is payable and the user sends native ETH (... | [View](#selector-d0e30db0) |

---

## ğŸ“ˆ Statistics

| Metric | Count |
|--------|-------|
| ğŸ”´ Critical | 1 |
| ğŸŸ¡ Major | 0 |
| ğŸŸ¢ Minor | 0 |
| âœ… No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>ğŸ“‹ ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>ğŸ” Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x9646131a5f8964249962bc33940affb82b76c7095105d436e84f40c0a28ce557`

**Block:** 23676565 | **From:** 0x2469875b7ac461e06d980a29c1fec57ced17d428 | **Value:** 43850000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0x6fd24f27886bf6a438ec6035348180d1e420ece10b97b2336990fdf70a3c2939`

**Block:** 23676563 | **From:** 0x431183d57a7b97925e88cf03dbea8818be1f7066 | **Value:** 1000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0xff41c29c4d45e5296871b58d001cc11f29374c63e7a7e6f3a0d46c11f85488b4`

**Block:** 23676558 | **From:** 0xc20adfc2afd2340499f652baa608bda8b5f24bb5 | **Value:** 20500000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0xdc65fdd3e9ae17fd662369862e44f877fd267d5ef58f1da772a846a2133d02ca`

**Block:** 23676558 | **From:** 0xb1931bfc796931f95acdb6288580f352c96560bf | **Value:** 300000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0xbc4487156e347e052dcac05821e7ac5af3f983842db4f4130ebaed21ae55e91e`

**Block:** 23676556 | **From:** 0xecaa514ce7ddf6a2174630ee49320cff8ff47b44 | **Value:** 70941515057513230

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

## ğŸ” Clear Signing Audit Report

### ğŸ“‹ Function: deposit()

**Selector:** 0xd0e30db0

---

### 1ï¸âƒ£ Intent Analysis

> **Declared Intent:** *"Wrap"*

The intent "Wrap" is accurate and succinct for a WETH-style deposit function; no spelling/grammar issues.

---

### 2ï¸âƒ£ Critical Issues

> ğŸ”´ **CRITICAL** - Issues that could lead to users being deceived or losing funds

- ERC-7730 metadata's fields array is empty while deposit() is payable and the user sends native ETH (msg.value). There is no field that displays the ETH amount being deposited. Per the spec, a payable function that accepts native ETH must present the amount (e.g. via "@.value" or tokenAmount with nativeCurrencyAddress). This omission is critical because a user will not see the actual ETH amount they are about to send.
- Because msg.value is not displayed, users can be surprised by the amount charged; this is especially problematic for functions whose only meaningful parameter is the ETH value sent.

(Notes checked and not flagged as critical: token inversion, wrong token address, recipient missing parameter â€” deposit() credits msg.sender and no recipient input exists â€” and there are no broken $ref references in the provided format.)

âœ… No other critical mismatches between displayed token and actual on-chain events were found â€” the action is native ETH deposit (wrap) and the metadata intent "Wrap" matches that. The only critical problem is the missing display of transferred ETH.

---

### 3ï¸âƒ£ Missing Parameters

> âš ï¸ *Parameters present in ABI but NOT shown to users in ERC-7730*

| Parameter | Why It's Important | Risk Level |
|-----------|--------------------|:----------:|
| @.value (msg.value) | Represents the native ETH amount the user is sending â€” the core input for deposit() | ğŸ”´ High |

Explanation: deposit() has no explicit ABI input but relies entirely on msg.value. The metadata must show @.value or equivalent tokenAmount with nativeCurrencyAddress to make that clear to the user.

---

### 4ï¸âƒ£ Display Issues

> ğŸŸ¡ **Issues with how information is presented to users**

- Empty fields array: No amount or token displayed. For a payable deposit function, this is a major presentation gap.
- Lack of explicit native token identification: Even if an amount field were added, the metadata should make clear that the user is sending native ETH (label "ETH" or similar) and that the contract credits wrapped balances (WETH). Right now only intent "Wrap" exists; that may be ambiguous to some users without an amount.
- No @.value or tokenAmount with nativeCurrencyAddress: As-is, display cannot represent native ETH.
- No use of the Deposit event mapping: On-chain logs emit Deposit(msg.sender, msg.value) (signature 0xe1fffcc4...), but the format does not expose or relate to that event â€” acceptable but the main missing piece is the pre-send display of msg.value.
- No broken $ref or missing definitions in provided metadata (but metadata is minimal/empty).

Suggested improvement: Add an explicit amount field referencing @.value, label it clearly (e.g., "ETH to deposit (wrap)"), and/or show that the result is credited as WETH balanceOf[msg.sender].

---

### 5ï¸âƒ£ Transaction Samples - What Users See vs What Actually Happens

(Analyzed three representative samples. Per instructions, I omit hashes/blocks/from/value fields from this section.)

#### ğŸ“ Transaction 1

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" |  |
| Amount | *No amount shown (fields array empty)* | msg.value (ETH sent) |
| Token | *No explicit token label* | Native ETH being transferred to contract and credited as balance (wrapped) |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | Deposit(sender, amount) emitted (signature 0xe1fffcc4...) | âŒ Not shown by metadata |
| Native ETH transfer | ETH moved from sender to contract balance (implied by deposit semantics/logs) | âŒ Not shown by metadata |

#### ğŸ“ Transaction 2

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" |  |
| Amount | *No amount shown* | msg.value (ETH sent) |
| Token | *No explicit token label* | Native ETH â†’ contract (wrapped) |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | Deposit(sender, amount) emitted | âŒ Not shown |
| Native ETH transfer | ETH moved into contract | âŒ Not shown |

#### ğŸ“ Transaction 3

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" |  |
| Amount | *No amount shown* | msg.value (ETH sent) |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | Deposit(sender, amount) emitted | âŒ Not shown |
| Native ETH transfer | ETH moved into contract and balanceOf incremented | âŒ Not shown |

Summary: In all examples, the contract emitted Deposit events and the sender's ETH was accepted. The metadata did not display the ETH amount or explicitly label the native token â€” users would not see the core transaction parameter.

---

### 6ï¸âƒ£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 2/10 | Intent present ("Wrap") but no fields; fails to show the single critical input (msg.value). |
| **Security Risk** | ğŸ”´ High | Omission of the ETH amount is likely to surprise users and cause incorrect approvals/amount expectations; must be fixed before display is used in a UX that asks users to confirm value. |

#### ğŸ’¡ Key Recommendations
- Add an explicit amount field that displays msg.value:
  - Minimal fix: {"path":"@.value","label":"Amount (ETH)","format":"amount"}
  - Better: Use tokenAmount with nativeCurrencyAddress to show token symbol and decimals, e.g. reference a native ETH sentinel in metadata.constants and use "$.display.definitions.tokenAmount" with nativeCurrencyAddress.
- Improve label clarity to connect action and result: label like "Deposit ETH (wrap to WETH)" so users understand they are sending native ETH and receiving wrapped balance.
- Optionally expose the Deposit event as part of post-execution display/receipt (not required for pre-execution consent) but can help reconcile what happened.

---

If you want, I can produce the exact ERC-7730 snippet to fix this (two variants: simple @.value amount, or tokenAmount with nativeCurrencyAddress + label "ETH â†’ WETH"). Which do you prefer?

---

