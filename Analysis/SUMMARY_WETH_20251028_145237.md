# ğŸ“Š Clear Signing Audit Report

**Generated:** 2025-10-28 14:52:37

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | ğŸ”´ Critical | ERCâ€‘7730 format has an empty fields array for a payable deposit() function. This means the UI will s... | [View](#selector-d0e30db0) |

---

## ğŸ“ˆ Statistics

| Metric | Count |
|--------|-------|
| ğŸ”´ Critical | 1 |
| ğŸŸ¡ Major | 0 |
| ğŸŸ¢ Minor | 0 |
| âœ… No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>ğŸ“‹ ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>ğŸ” Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x8836b9e4f147bdbe6d5b3dcb82ecb02d7f454c0a3759532920df350a99708384`

**Block:** 23676623 | **From:** 0x31cb71a69dc2fa0a1f143e1370918107a5c56d45 | **Value:** 100000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0x167533db84ebfbee44c610ff9980be2ee34966d10f011e8b5c21429b9cfb4f46`

**Block:** 23676619 | **From:** 0x4d7865cc31411ab4e411d90557ed8ae501f6d7aa | **Value:** 4000000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0x5b3e596ed698f77448275848a322579a07c682270a00c59459d6c6f27b8b259b`

**Block:** 23676618 | **From:** 0xf16d8e8b2a37a1e1ccb4315850609e2e02d397e7 | **Value:** 16000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0x30e3d063d13da11be99657dd9524b855f96f3bc78b61191fe9c37181bacb2ab6`

**Block:** 23676616 | **From:** 0x608e97e7d4b6a160328496597dbc55604339be83 | **Value:** 69982879857262192

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0xdf3d36f3010e2ab08b4f008beba65d59d9c033412302febd61816c77a55cf6e2`

**Block:** 23676613 | **From:** 0x608e97e7d4b6a160328496597dbc55604339be83 | **Value:** 17120142737808

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

## ğŸ” Clear Signing Audit Report

### ğŸ“‹ Function: deposit()

**Selector:** 0xd0e30db0

---

### 1ï¸âƒ£ Intent Analysis

> **Declared Intent:** *"Wrap"*

The intent "Wrap" is accurate and clear â€” deposit() is the WETH-style payable wrapper that converts incoming native ETH into WETH balance for msg.sender.

---

### 2ï¸âƒ£ Critical Issues

> ğŸ”´ **CRITICAL** - Issues that could lead to users being deceived or losing funds

- ERCâ€‘7730 format has an empty fields array for a payable deposit() function. This means the UI will show the intent ("Wrap") but will not display the ETH amount the user is sending (msg.value). Per the spec rules, a payable function that accepts ETH must surface the amount (e.g., via "@.value") â€” omission is CRITICAL.
- ERCâ€‘7730 metadata does not show the resulting token (WETH) being credited. User wraps ETH and receives WETH balance, but the display contains no receiving-token/tokenAddress information â€” user could be surprised they receive WETH rather than plain ETH.

Notes on other critical checks:
- No broken $ref references detected (metadata fields array is simply empty).
- There are no input parameter path mismatches (function has no ABI inputs).
- Receipt logs show Deposit events from the WETH contract (signature 0xe1fffcc4...), confirming ETHâ†’WETH wrap behavior â€” consistent with code, but not exposed in metadata.

âœ… No other critical issues found.

---

### 3ï¸âƒ£ Missing Parameters

> âš ï¸ *Parameters present in ABI but NOT shown to users in ERC-7730*

The function has no ABI parameters, but the following runtime values are not displayed:

| Parameter | Why It's Important | Risk Level |
|-----------|--------------------|:----------:|
| msg.value (ETH amount sent) | This is the actual amount the user is sending and will be wrapped into WETH â€” must be shown so user knows how much ETH is spent | ğŸ”´ High |
| Received token (WETH address / amount credited) | Shows what token the user receives in return (WETH) and how much WETH will be credited | ğŸ”´ High |

(Reasoning: although msg.value is not an ABI input, the spec expects payable flows to show @.value or equivalent. Omission is critical.)

---

### 4ï¸âƒ£ Display Issues

> ğŸŸ¡ **Issues with how information is presented to users**

- Fields array is empty â€” no amounts or token identifiers are presented. Minimal display (just intent) is insufficient for a payable wrap action.
- No explicit indication that the result is WETH (ERCâ€‘20) credited to the user. The metadata should show both the incoming ETH amount and the outgoing WETH tokenAmount.
- If implementers try to show the amount as a tokenAmount referencing a user-supplied tokenPath, that's risky here: deposit() has no user token input â€” the receiving token is contract-defined (WETH). The token must be shown as the WETH contract address (constant), not a user-supplied tokenPath.
- No use of nativeCurrencyAddress or @.value in metadata â€” native ETH will not be displayed properly.
- Spelling/grammar: intent "Wrap" is fine.

Recommended display fixes:
- Add "@.value" amount field.
- Add a receiving tokenAmount field with tokenPath pointing to a constant (WETH address), or a label like "Receive: WETH".
- Ensure definitions/constants include nativeCurrencyAddress sentinel if showing ETH as native.

---

### 5ï¸âƒ£ Transaction Samples - What Users See vs What Actually Happens

(Selected 3 samples from provided list â€” showing core mismatch: no amount displayed vs logs show Deposit events)

#### ğŸ“ Transaction 1

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | Amount of ETH being sent (@.value) |
| â€” | â€” | Receiving token (WETH) and amount credited |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | Contract (WETH) emitted Deposit(from, amount) â€” userâ€™s balanceOf increased by msg.value | âŒ No (amount not shown in metadata) |
| No ERC20 Transfer logs shown in receipt_logs here (WETH uses internal accounting), but function credits WETH balance | WETH balance increased for msg.sender | âŒ No (receiving token not shown) |

Result: UI shows "Wrap" only; on-chain the user sent ETH and received WETH credit equal to msg.value.

#### ğŸ“ Transaction 2

**User Intent (from ERC-7730):**

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Intent | "Wrap" | Exact ETH amount wrapped; receiving WETH |

**Actual Effects (from receipt_logs):**

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | Deposit(from, amount) with amount present in log data | âŒ No (not shown by metadata) |

Same discrepancy.

#### ğŸ“ Transaction 3

(Another deposit same pattern)

User sees only intent; chain shows Deposit event crediting WETH.

---

### 6ï¸âƒ£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 2/10 | Metadata only states intent "Wrap" and provides zero fields. It fails to show the critical amount and receiving token. |
| **Security Risk** | ğŸ”´ High | Users may not see the ETH amount they are sending nor that they receive WETH; this can cause confusion and unexpected balances (high-impact UX/security). |

#### ğŸ’¡ Key Recommendations
- Add an explicit amount field for msg.value:
  - Minimal fix: {"path":"@.value","label":"Amount (ETH)","format":"amount"}
  - Better: tokenAmount version referencing nativeCurrencyAddress so UI shows native ETH symbol.
- Add a receiving token field showing WETH:
  - Example: {"path":"@.value","label":"Receive WETH","format":"tokenAmount","params":{"tokenAddress":["$.metadata.constants.wethAddress"], "decimals":18}} â€” or use definitions/constants to reference 0xC02aa...
- Add metadata constant for WETH address (0xC02aa...cc2) and ensure tokenAmount definition supports ERCâ€‘20 display.
- Ensure display text clarifies action: "Wrap ETH â†’ WETH" and show both sides (ETH spent, WETH received).
- Test with sample transactions to confirm UI shows the exact msg.value and indicates WETH as the received asset.

---

If you want, I can produce the exact ERCâ€‘7730 JSON patch (fields + definitions/constants) to fix the display (adds @.value and WETH token fields).

---

