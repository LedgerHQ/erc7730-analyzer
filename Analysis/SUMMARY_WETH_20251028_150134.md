# ğŸ“Š Clear Signing Audit Report

**Generated:** 2025-10-28 15:01:34

**Contract ID:** WETH

**Total Deployments Analyzed:** 2

**Chain IDs:** 1, 11155111

---

## Summary Table

| Function | Selector | Severity | Issues | Link |
|----------|----------|----------|--------|------|
| `deposit` | `0xd0e30db0` | ğŸ”´ Critical | ERC-7730 metadata provides no fields (empty fields array) for this payable function. deposit() uses ... | [View](#selector-d0e30db0) |

---

## ğŸ“ˆ Statistics

| Metric | Count |
|--------|-------|
| ğŸ”´ Critical | 1 |
| ğŸŸ¡ Major | 0 |
| ğŸŸ¢ Minor | 0 |
| âœ… No Issues | 0 |
| **Total** | **1** |

---

# Detailed Analysis

## <a id="selector-d0e30db0"></a> deposit

**Selector:** `0xd0e30db0` | **Signature:** `deposit()`

**Contract Address:** `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2` | **Chain ID:** 1

<details>
<summary><b>ğŸ“‹ ERC-7730 Format Definition</b></summary>

```json
{
  "format": {
    "intent": "Wrap",
    "fields": []
  }
}
```

</details>

<details>
<summary><b>ğŸ” Side-by-Side Comparison (ABI vs ERC-7730)</b></summary>

### Transaction 1: `0x377609bea0986bfe184568e448b43f75408449b78fd70e8453f22c895d86e9cb`

**Block:** 23676642 | **From:** 0x2b9115abb961a41fa11a4846806c77ae7c94e7a5 | **Value:** 3000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 2: `0xbb8f3ad446fd26b3357e4431a1f42ab4214a9fd0c5ecd7340dc9e713e8914b6c`

**Block:** 23676642 | **From:** 0x84ff5b0a8162e60afc599ad98d7209eeb36a6a14 | **Value:** 770000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 3: `0xbcb6971104d98468edd7a3945d82137bde553ace785d0cc10f5e081446e51376`

**Block:** 23676636 | **From:** 0xba13baa2e8037d81be8a1fd165d5a28595aac456 | **Value:** 1260000000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 4: `0x82151c7ce5201e2dc39d7f618550cb2f5ffe546c26ee46f3249092fa9e2fd392`

**Block:** 23676636 | **From:** 0xe83f75907fb4c575414fa6f5cfe8cef24dc5870c | **Value:** 11999800000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

### Transaction 5: `0x8836b9e4f147bdbe6d5b3dcb82ecb02d7f454c0a3759532920df350a99708384`

**Block:** 23676623 | **From:** 0x31cb71a69dc2fa0a1f143e1370918107a5c56d45 | **Value:** 100000000000000

| Parameter | ABI-Decoded (Raw) | ERC-7730 (User Sees) |
|-----------|-------------------|----------------------|

#### ğŸ“‹ Transaction Events (from receipt)

| Event | Token | Details | Amount |
|-------|-------|---------|--------|
| â“ Unknown | `0xc02aaa39...` | Signature: `0xe1fffcc4923d04b5...` | - |

</details>

---

## ğŸ” Clear Signing Audit Report

### ğŸ“‹ Function: deposit()
Selector: 0xd0e30db0

---

### 1ï¸âƒ£ Intent Analysis

> **Declared Intent:** *"Wrap"*

The intent "Wrap" is accurate and concise for a WETH-style deposit (taking native ETH and crediting token balance), and there are no spelling/grammar errors.

---

### 2ï¸âƒ£ Critical Issues

> ğŸ”´ **CRITICAL** - Issues that could lead to users being deceived or losing funds

- ERC-7730 metadata provides no fields (empty fields array) for this payable function. deposit() uses msg.value (native ETH) to increase the caller's token balance; because there is no field showing @.value or any tokenAmount with nativeCurrencyAddress, the actual ETH amount the user is sending will not be shown in the UI. Per the spec's payable-function rules, this is CRITICAL: a payable function that accepts only native ETH must show the msg.value (or an equivalent tokenAmount supporting nativeCurrencyAddress). Users could be surprised/shocked because no amount appears even though they are sending ETH.

No other critical issues found:
- The declared intent matches the function behavior.
- There are no ABI input parameters omitted (function has none).
- No broken $ref or missing definitions in the provided fragment (there are simply no fields).

---

### 3ï¸âƒ£ Missing Parameters

> âš ï¸ *Parameters present in ABI but NOT shown to users in ERC-7730*

| Parameter | Why It's Important | Risk Level |
|-----------|-------------------|:----------:|
| (none) | Function has no input parameters | ğŸŸ¢ Low |

âœ… All ABI parameters (there are none) are covered.  
However: msg.value is not an ABI parameter but is the crucial value here and it is not shown â€” this is captured as a critical issue above.

---

### 4ï¸âƒ£ Display Issues

> ğŸŸ¡ **Issues with how information is presented to users**

- Empty fields array: No amount/asset is displayed for a payable deposit. This is the primary display problem.
- No nativeCurrencyAddress / tokenAmount: There is no mechanism in the metadata to display native ETH as a tokenAmount (e.g., via a native sentinel or nativeCurrencyAddress). If the UI relies on tokenAmount formatting, it cannot show ETH properly here.
- Lack of descriptive label: The intent "Wrap" is correct but the display should explicitly say "Deposit (wrap ETH â†’ WETH)" or similar to avoid ambiguity.
- Orphaned/unused definitions/constants: Not applicable here (none provided), but the metadata is minimal and omits fields rather than mis-referencing anything.

Display edge-case note:
- The contract always consumes msg.value (native ETH). Because the display relies on user-specified fields and those are absent, the UI will show nothing for the amount. This is a mediumâ†’high usability issue (already flagged as critical because payable ETH wasn't shown).

---

### 5ï¸âƒ£ Transaction Samples - What Users See vs What Actually Happens

(Analyzed 3 sample transactions from receipt_logs. Per instructions, I omit hash/block/from/value fields.)

#### ğŸ“ Transaction 1

User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Label / Amount | None (fields array empty) | msg.value (the ETH amount being deposited) |
| Asset type | None | Native ETH â†’ credited as WETH token balance |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit (Unknown signature) | Event shows depositor address and amount (msg.value) | âŒ No â€” not surfaced by ERC-7730 fields |
| balanceOf update (on-chain) | Contract increments balanceOf[msg.sender] by msg.value (WETH bookkeeping) | âŒ No â€” internal state change not shown in metadata |

#### ğŸ“ Transaction 2 (similar)

User Intent (from ERC-7730):

| Field | âœ… User Sees | âŒ Hidden/Missing |
|-------|-------------|-------------------|
| Label / Amount | None | msg.value (ETH sent) |
| Asset type | None | Native ETH â†’ WETH balance credited |

Actual Effects (from receipt_logs):

| Event | Details | Disclosed? |
|-------|---------|:----------:|
| Deposit event | Shows depositor address + amount (msg.value) | âŒ No |
| balanceOf increment | WETH balance increased | âŒ No |

#### ğŸ“ Transaction 3 (similar)

Same pattern: user metadata shows nothing about amounts/assets; receipt_logs show Deposit events with actual ETH amounts credited. Not disclosed.

---

### 6ï¸âƒ£ Overall Assessment

| Metric | Score/Rating | Explanation |
|--------|--------------|-------------|
| **Coverage Score** | 2/10 | Metadata intent is correct ("Wrap") but coverage is minimal: no amount, no asset identification, no labels. |
| **Security Risk** | ğŸ”´ High (UI/UX risk) | Users can send native ETH via deposit() but the UI will not show the amount or asset â€” this can cause surprise and loss-of-trust (though not an on-chain theft by this contract code). |

#### ğŸ’¡ Key Recommendations
- Show msg.value explicitly:
  - Add a field: {"path":"@.value","label":"Amount","format":"amount"} â€” this directly displays the ETH the user is sending.
  - Or add a tokenAmount field referencing a native sentinel (nativeCurrencyAddress) so the UI shows "ETH" with correct decimals and symbol.
- Improve labels: change intent/labels to explicitly state the operation, e.g. intent "Wrap", label "Deposit (Wrap ETH â†’ WETH)".
- Include a token display: since deposit credits an on-chain token balance, metadata should indicate the token received (WETH) â€” either via a constant pointing to the WETH contract address or an explicit label so users understand they are wrapping ETH into WETH.
- Test render: ensure the wallet/UI follows $ref for nativeCurrencyAddress or supports @.value; add a test transaction to validate the amount shows correctly.

---

Summary: The metadata correctly identifies this as a "Wrap" operation, and the on-chain behavior (balanceOf[msg.sender] += msg.value; emit Deposit) matches that intent. However, because the ERC-7730 "fields" array is empty, the interface will not show the ETH amount the user is sending (msg.value). That omission is critical for payable functions â€” add an @.value or tokenAmount field with nativeCurrencyAddress to fix.

---

